{
  "data": {
    "edges": [
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "ChatInput",
            "id": "ChatInput-0R8KM",
            "name": "message",
            "output_types": [
              "Message"
            ]
          },
          "targetHandle": {
            "fieldName": "input_value",
            "id": "Cuga-h25LW",
            "inputTypes": [
              "Message"
            ],
            "type": "str"
          }
        },
        "id": "xy-edge__ChatInput-0R8KM{œdataTypeœ:œChatInputœ,œidœ:œChatInput-0R8KMœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}-Cuga-h25LW{œfieldNameœ:œinput_valueœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}",
        "selected": false,
        "source": "ChatInput-0R8KM",
        "sourceHandle": "{œdataTypeœ:œChatInputœ,œidœ:œChatInput-0R8KMœ,œnameœ:œmessageœ,œoutput_typesœ:[œMessageœ]}",
        "target": "Cuga-h25LW",
        "targetHandle": "{œfieldNameœ:œinput_valueœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œMessageœ],œtypeœ:œstrœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "Cuga",
            "id": "Cuga-h25LW",
            "name": "response",
            "output_types": [
              "Message"
            ]
          },
          "targetHandle": {
            "fieldName": "input_value",
            "id": "ChatOutput-yHar7",
            "inputTypes": [
              "Data",
              "DataFrame",
              "Message"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__Cuga-h25LW{œdataTypeœ:œCugaœ,œidœ:œCuga-h25LWœ,œnameœ:œresponseœ,œoutput_typesœ:[œMessageœ]}-ChatOutput-yHar7{œfieldNameœ:œinput_valueœ,œidœ:œChatOutput-yHar7œ,œinputTypesœ:[œDataœ,œDataFrameœ,œMessageœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "Cuga-h25LW",
        "sourceHandle": "{œdataTypeœ:œCugaœ,œidœ:œCuga-h25LWœ,œnameœ:œresponseœ,œoutput_typesœ:[œMessageœ]}",
        "target": "ChatOutput-yHar7",
        "targetHandle": "{œfieldNameœ:œinput_valueœ,œidœ:œChatOutput-yHar7œ,œinputTypesœ:[œDataœ,œDataFrameœ,œMessageœ],œtypeœ:œotherœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "ComposioGmailAPIComponent",
            "id": "ComposioGmailAPIComponent-Rc6PI",
            "name": "component_as_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "Cuga-h25LW",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__ComposioGmailAPIComponent-Rc6PI{œdataTypeœ:œComposioGmailAPIComponentœ,œidœ:œComposioGmailAPIComponent-Rc6PIœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}-Cuga-h25LW{œfieldNameœ:œtoolsœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "ComposioGmailAPIComponent-Rc6PI",
        "sourceHandle": "{œdataTypeœ:œComposioGmailAPIComponentœ,œidœ:œComposioGmailAPIComponent-Rc6PIœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "Cuga-h25LW",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "MCPTools",
            "id": "MCPTools-6jiqJ",
            "name": "component_as_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "Cuga-h25LW",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__MCPTools-6jiqJ{œdataTypeœ:œMCPToolsœ,œidœ:œMCPTools-6jiqJœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}-Cuga-h25LW{œfieldNameœ:œtoolsœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "MCPTools-6jiqJ",
        "sourceHandle": "{œdataTypeœ:œMCPToolsœ,œidœ:œMCPTools-6jiqJœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "Cuga-h25LW",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      },
      {
        "animated": false,
        "className": "",
        "data": {
          "sourceHandle": {
            "dataType": "MCPTools",
            "id": "MCPTools-YTBps",
            "name": "component_as_tool",
            "output_types": [
              "Tool"
            ]
          },
          "targetHandle": {
            "fieldName": "tools",
            "id": "Cuga-h25LW",
            "inputTypes": [
              "Tool"
            ],
            "type": "other"
          }
        },
        "id": "xy-edge__MCPTools-YTBps{œdataTypeœ:œMCPToolsœ,œidœ:œMCPTools-YTBpsœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}-Cuga-h25LW{œfieldNameœ:œtoolsœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}",
        "selected": false,
        "source": "MCPTools-YTBps",
        "sourceHandle": "{œdataTypeœ:œMCPToolsœ,œidœ:œMCPTools-YTBpsœ,œnameœ:œcomponent_as_toolœ,œoutput_typesœ:[œToolœ]}",
        "target": "Cuga-h25LW",
        "targetHandle": "{œfieldNameœ:œtoolsœ,œidœ:œCuga-h25LWœ,œinputTypesœ:[œToolœ],œtypeœ:œotherœ}"
      }
    ],
    "nodes": [
      {
        "data": {
          "id": "MCPTools-YTBps",
          "node": {
            "base_classes": [
              "DataFrame"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Connect to an MCP server to use its tools.",
            "display_name": "MCP Tools",
            "documentation": "https://docs.langflow.org/mcp-tools",
            "edited": false,
            "field_order": [
              "mcp_server",
              "use_cache",
              "verify_ssl",
              "tool",
              "tool_placeholder"
            ],
            "frozen": false,
            "icon": "Mcp",
            "last_updated": "2025-12-18T10:50:05.652Z",
            "legacy": false,
            "lf_version": "1.7.0",
            "metadata": {
              "code_hash": "39187e27d938",
              "dependencies": {
                "dependencies": [
                  {
                    "name": "langchain_core",
                    "version": "0.3.80"
                  },
                  {
                    "name": "lfx",
                    "version": null
                  },
                  {
                    "name": "langflow",
                    "version": null
                  }
                ],
                "total_dependencies": 3
              },
              "module": "custom_components.mcp_tools"
            },
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Toolset",
                "group_outputs": false,
                "hidden": null,
                "loop_types": null,
                "method": "to_toolkit",
                "name": "component_as_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_frontend_node_flow_id": {
                "value": "af63ae2e-2804-4ab5-9259-4e337a09a401"
              },
              "_frontend_node_folder_id": {
                "value": "9d4e6e89-4355-4367-8927-de9e2800dfeb"
              },
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from __future__ import annotations\n\nimport asyncio\nimport json\nimport uuid\n\nfrom langchain_core.tools import StructuredTool  # noqa: TC002\n\nfrom lfx.base.agents.utils import maybe_unflatten_dict, safe_cache_get, safe_cache_set\nfrom lfx.base.mcp.util import (\n    MCPStdioClient,\n    MCPStreamableHttpClient,\n    create_input_schema_from_json_schema,\n    update_tools,\n)\nfrom lfx.custom.custom_component.component_with_cache import ComponentWithCache\nfrom lfx.inputs.inputs import InputTypes  # noqa: TC001\nfrom lfx.io import BoolInput, DropdownInput, McpInput, MessageTextInput, Output\nfrom lfx.io.schema import flatten_schema, schema_to_langflow_inputs\nfrom lfx.log.logger import logger\nfrom lfx.schema.dataframe import DataFrame\nfrom lfx.schema.message import Message\nfrom lfx.services.deps import get_settings_service, get_storage_service, session_scope\n\n\ndef resolve_mcp_config(\n    server_name: str,  # noqa: ARG001\n    server_config_from_value: dict | None,\n    server_config_from_db: dict | None,\n) -> dict | None:\n    \"\"\"Resolve MCP server config with proper precedence.\n\n    Resolves the configuration for an MCP server with the following precedence:\n    1. Database config (takes priority) - ensures edits are reflected\n    2. Config from value/tweaks (fallback) - allows REST API to provide config for new servers\n\n    Args:\n        server_name: Name of the MCP server\n        server_config_from_value: Config provided via value/tweaks (optional)\n        server_config_from_db: Config from database (optional)\n\n    Returns:\n        Final config to use (DB takes priority, falls back to value)\n        Returns None if no config found in either location\n    \"\"\"\n    if server_config_from_db:\n        return server_config_from_db\n    return server_config_from_value\n\n\nclass MCPToolsComponent(ComponentWithCache):\n    schema_inputs: list = []\n    tools: list[StructuredTool] = []\n    _not_load_actions: bool = False\n    _tool_cache: dict = {}\n    _last_selected_server: str | None = None  # Cache for the last selected server\n\n    def __init__(self, **data) -> None:\n        super().__init__(**data)\n        # Initialize cache keys to avoid CacheMiss when accessing them\n        self._ensure_cache_structure()\n\n        # Initialize clients with access to the component cache\n        self.stdio_client: MCPStdioClient = MCPStdioClient(component_cache=self._shared_component_cache)\n        self.streamable_http_client: MCPStreamableHttpClient = MCPStreamableHttpClient(\n            component_cache=self._shared_component_cache\n        )\n\n    def _ensure_cache_structure(self):\n        \"\"\"Ensure the cache has the required structure.\"\"\"\n        # Check if servers key exists and is not CacheMiss\n        servers_value = safe_cache_get(self._shared_component_cache, \"servers\")\n        if servers_value is None:\n            safe_cache_set(self._shared_component_cache, \"servers\", {})\n\n        # Check if last_selected_server key exists and is not CacheMiss\n        last_server_value = safe_cache_get(self._shared_component_cache, \"last_selected_server\")\n        if last_server_value is None:\n            safe_cache_set(self._shared_component_cache, \"last_selected_server\", \"\")\n\n    default_keys: list[str] = [\n        \"code\",\n        \"_type\",\n        \"tool_mode\",\n        \"tool_placeholder\",\n        \"mcp_server\",\n        \"tool\",\n        \"use_cache\",\n        \"verify_ssl\",\n    ]\n\n    display_name = \"MCP Tools\"\n    description = \"Connect to an MCP server to use its tools.\"\n    documentation: str = \"https://docs.langflow.org/mcp-tools\"\n    icon = \"Mcp\"\n    name = \"MCPTools\"\n\n    inputs = [\n        McpInput(\n            name=\"mcp_server\",\n            display_name=\"MCP Server\",\n            info=\"Select the MCP Server that will be used by this component\",\n            real_time_refresh=True,\n        ),\n        BoolInput(\n            name=\"use_cache\",\n            display_name=\"Use Cached Server\",\n            info=(\n                \"Enable caching of MCP Server and tools to improve performance. \"\n                \"Disable to always fetch fresh tools and server updates.\"\n            ),\n            value=False,\n            advanced=True,\n        ),\n        BoolInput(\n            name=\"verify_ssl\",\n            display_name=\"Verify SSL Certificate\",\n            info=(\n                \"Enable SSL certificate verification for HTTPS connections. \"\n                \"Disable only for development/testing with self-signed certificates.\"\n            ),\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"tool\",\n            display_name=\"Tool\",\n            options=[],\n            value=\"\",\n            info=\"Select the tool to execute\",\n            show=False,\n            required=True,\n            real_time_refresh=True,\n        ),\n        MessageTextInput(\n            name=\"tool_placeholder\",\n            display_name=\"Tool Placeholder\",\n            info=\"Placeholder for the tool\",\n            value=\"\",\n            show=False,\n            tool_mode=False,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Response\", name=\"response\", method=\"build_output\"),\n    ]\n\n    async def _validate_schema_inputs(self, tool_obj) -> list[InputTypes]:\n        \"\"\"Validate and process schema inputs for a tool.\"\"\"\n        try:\n            if not tool_obj or not hasattr(tool_obj, \"args_schema\"):\n                msg = \"Invalid tool object or missing input schema\"\n                raise ValueError(msg)\n\n            flat_schema = flatten_schema(tool_obj.args_schema.schema())\n            input_schema = create_input_schema_from_json_schema(flat_schema)\n            if not input_schema:\n                msg = f\"Empty input schema for tool '{tool_obj.name}'\"\n                raise ValueError(msg)\n\n            schema_inputs = schema_to_langflow_inputs(input_schema)\n            if not schema_inputs:\n                msg = f\"No input parameters defined for tool '{tool_obj.name}'\"\n                await logger.awarning(msg)\n                return []\n\n        except Exception as e:\n            msg = f\"Error validating schema inputs: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n        else:\n            return schema_inputs\n\n    async def update_tool_list(self, mcp_server_value=None):\n        # Accepts mcp_server_value as dict {name, config} or uses self.mcp_server\n        mcp_server = mcp_server_value if mcp_server_value is not None else getattr(self, \"mcp_server\", None)\n        server_name = None\n        server_config_from_value = None\n        if isinstance(mcp_server, dict):\n            server_name = mcp_server.get(\"name\")\n            server_config_from_value = mcp_server.get(\"config\")\n        else:\n            server_name = mcp_server\n        if not server_name:\n            self.tools = []\n            return [], {\"name\": server_name, \"config\": server_config_from_value}\n\n        # Check if caching is enabled, default to False\n        use_cache = getattr(self, \"use_cache\", False)\n\n        # Use shared cache if available and caching is enabled\n        cached = None\n        if use_cache:\n            servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n            cached = servers_cache.get(server_name) if isinstance(servers_cache, dict) else None\n\n        if cached is not None:\n            try:\n                self.tools = cached[\"tools\"]\n                self.tool_names = cached[\"tool_names\"]\n                self._tool_cache = cached[\"tool_cache\"]\n                server_config_from_value = cached[\"config\"]\n            except (TypeError, KeyError, AttributeError) as e:\n                # Handle corrupted cache data by clearing it and continuing to fetch fresh tools\n                msg = f\"Unable to use cached data for MCP Server{server_name}: {e}\"\n                await logger.awarning(msg)\n                # Clear the corrupted cache entry\n                current_servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                if isinstance(current_servers_cache, dict) and server_name in current_servers_cache:\n                    current_servers_cache.pop(server_name)\n                    safe_cache_set(self._shared_component_cache, \"servers\", current_servers_cache)\n            else:\n                return self.tools, {\"name\": server_name, \"config\": server_config_from_value}\n\n        try:\n            # Try to fetch from database first to ensure we have the latest config\n            # This ensures database updates (like editing a server) take effect\n            try:\n                from langflow.api.v2.mcp import get_server\n                from langflow.services.database.models.user.crud import get_user_by_id\n            except ImportError as e:\n                msg = (\n                    \"Langflow MCP server functionality is not available. \"\n                    \"This feature requires the full Langflow installation.\"\n                )\n                raise ImportError(msg) from e\n\n            server_config_from_db = None\n            async with session_scope() as db:\n                if not self.user_id:\n                    msg = \"User ID is required for fetching MCP tools.\"\n                    raise ValueError(msg)\n                current_user = await get_user_by_id(db, self.user_id)\n\n                # Try to get server config from DB/API\n                server_config_from_db = await get_server(\n                    server_name,\n                    current_user,\n                    db,\n                    storage_service=get_storage_service(),\n                    settings_service=get_settings_service(),\n                )\n\n            # Resolve config with proper precedence: DB takes priority, falls back to value\n            server_config = resolve_mcp_config(\n                server_name=server_name,\n                server_config_from_value=server_config_from_value,\n                server_config_from_db=server_config_from_db,\n            )\n\n            if not server_config:\n                self.tools = []\n                return [], {\"name\": server_name, \"config\": server_config}\n\n            # Add verify_ssl option to server config if not present\n            if \"verify_ssl\" not in server_config:\n                verify_ssl = getattr(self, \"verify_ssl\", True)\n                server_config[\"verify_ssl\"] = verify_ssl\n\n            _, tool_list, tool_cache = await update_tools(\n                server_name=server_name,\n                server_config=server_config,\n                mcp_stdio_client=self.stdio_client,\n                mcp_streamable_http_client=self.streamable_http_client,\n            )\n\n            self.tool_names = [tool.name for tool in tool_list if hasattr(tool, \"name\")]\n            self._tool_cache = tool_cache\n            self.tools = tool_list\n\n            # Cache the result only if caching is enabled\n            if use_cache:\n                cache_data = {\n                    \"tools\": tool_list,\n                    \"tool_names\": self.tool_names,\n                    \"tool_cache\": tool_cache,\n                    \"config\": server_config,\n                }\n\n                # Safely update the servers cache\n                current_servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                if isinstance(current_servers_cache, dict):\n                    current_servers_cache[server_name] = cache_data\n                    safe_cache_set(self._shared_component_cache, \"servers\", current_servers_cache)\n\n        except (TimeoutError, asyncio.TimeoutError) as e:\n            msg = f\"Timeout updating tool list: {e!s}\"\n            await logger.aexception(msg)\n            raise TimeoutError(msg) from e\n        except Exception as e:\n            msg = f\"Error updating tool list: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n        else:\n            return tool_list, {\"name\": server_name, \"config\": server_config}\n\n    async def update_build_config(self, build_config: dict, field_value: str, field_name: str | None = None) -> dict:\n        \"\"\"Toggle the visibility of connection-specific fields based on the selected mode.\"\"\"\n        try:\n            if field_name == \"tool\":\n                try:\n                    # Always refresh tools when cache is disabled, or when tools list is empty\n                    # This ensures database edits are reflected immediately when cache is disabled\n                    use_cache = getattr(self, \"use_cache\", False)\n                    if len(self.tools) == 0 or not use_cache:\n                        try:\n                            self.tools, build_config[\"mcp_server\"][\"value\"] = await self.update_tool_list()\n                            build_config[\"tool\"][\"options\"] = [tool.name for tool in self.tools]\n                            build_config[\"tool\"][\"placeholder\"] = \"Select a tool\"\n                        except (TimeoutError, asyncio.TimeoutError) as e:\n                            msg = f\"Timeout updating tool list: {e!s}\"\n                            await logger.aexception(msg)\n                            if not build_config[\"tools_metadata\"][\"show\"]:\n                                build_config[\"tool\"][\"show\"] = True\n                                build_config[\"tool\"][\"options\"] = []\n                                build_config[\"tool\"][\"value\"] = \"\"\n                                build_config[\"tool\"][\"placeholder\"] = \"Timeout on MCP server\"\n                            else:\n                                build_config[\"tool\"][\"show\"] = False\n                        except ValueError:\n                            if not build_config[\"tools_metadata\"][\"show\"]:\n                                build_config[\"tool\"][\"show\"] = True\n                                build_config[\"tool\"][\"options\"] = []\n                                build_config[\"tool\"][\"value\"] = \"\"\n                                build_config[\"tool\"][\"placeholder\"] = \"Error on MCP Server\"\n                            else:\n                                build_config[\"tool\"][\"show\"] = False\n\n                    if field_value == \"\":\n                        return build_config\n                    tool_obj = None\n                    for tool in self.tools:\n                        if tool.name == field_value:\n                            tool_obj = tool\n                            break\n                    if tool_obj is None:\n                        msg = f\"Tool {field_value} not found in available tools: {self.tools}\"\n                        await logger.awarning(msg)\n                        return build_config\n                    await self._update_tool_config(build_config, field_value)\n                except Exception as e:\n                    build_config[\"tool\"][\"options\"] = []\n                    msg = f\"Failed to update tools: {e!s}\"\n                    raise ValueError(msg) from e\n                else:\n                    return build_config\n            elif field_name == \"mcp_server\":\n                if not field_value:\n                    build_config[\"tool\"][\"show\"] = False\n                    build_config[\"tool\"][\"options\"] = []\n                    build_config[\"tool\"][\"value\"] = \"\"\n                    build_config[\"tool\"][\"placeholder\"] = \"\"\n                    build_config[\"tool_placeholder\"][\"tool_mode\"] = False\n                    self.remove_non_default_keys(build_config)\n                    return build_config\n\n                build_config[\"tool_placeholder\"][\"tool_mode\"] = True\n\n                current_server_name = field_value.get(\"name\") if isinstance(field_value, dict) else field_value\n                _last_selected_server = safe_cache_get(self._shared_component_cache, \"last_selected_server\", \"\")\n                server_changed = current_server_name != _last_selected_server\n\n                # Determine if \"Tool Mode\" is active by checking if the tool dropdown is hidden.\n                is_in_tool_mode = build_config[\"tools_metadata\"][\"show\"]\n\n                # Get use_cache setting to determine if we should use cached data\n                use_cache = getattr(self, \"use_cache\", False)\n\n                # Fast path: if server didn't change and we already have options, keep them as-is\n                # BUT only if caching is enabled or we're in tool mode\n                existing_options = build_config.get(\"tool\", {}).get(\"options\") or []\n                if not server_changed and existing_options:\n                    # In non-tool mode with cache disabled, skip the fast path to force refresh\n                    if not is_in_tool_mode and not use_cache:\n                        pass  # Continue to refresh logic below\n                    else:\n                        if not is_in_tool_mode:\n                            build_config[\"tool\"][\"show\"] = True\n                        return build_config\n\n                # To avoid unnecessary updates, only proceed if the server has actually changed\n                # OR if caching is disabled (to force refresh in non-tool mode)\n                if (_last_selected_server in (current_server_name, \"\")) and build_config[\"tool\"][\"show\"] and use_cache:\n                    if current_server_name:\n                        servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                        if isinstance(servers_cache, dict):\n                            cached = servers_cache.get(current_server_name)\n                            if cached is not None and cached.get(\"tool_names\"):\n                                cached_tools = cached[\"tool_names\"]\n                                current_tools = build_config[\"tool\"][\"options\"]\n                                if current_tools == cached_tools:\n                                    return build_config\n                    else:\n                        return build_config\n                safe_cache_set(self._shared_component_cache, \"last_selected_server\", current_server_name)\n\n                # When cache is disabled, clear any cached data for this server\n                # This ensures we always fetch fresh data from the database\n                if not use_cache and current_server_name:\n                    servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                    if isinstance(servers_cache, dict) and current_server_name in servers_cache:\n                        servers_cache.pop(current_server_name)\n                        safe_cache_set(self._shared_component_cache, \"servers\", servers_cache)\n\n                # Check if tools are already cached for this server before clearing\n                cached_tools = None\n                if current_server_name and use_cache:\n                    servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                    if isinstance(servers_cache, dict):\n                        cached = servers_cache.get(current_server_name)\n                        if cached is not None:\n                            try:\n                                cached_tools = cached[\"tools\"]\n                                self.tools = cached_tools\n                                self.tool_names = cached[\"tool_names\"]\n                                self._tool_cache = cached[\"tool_cache\"]\n                            except (TypeError, KeyError, AttributeError) as e:\n                                # Handle corrupted cache data by ignoring it\n                                msg = f\"Unable to use cached data for MCP Server,{current_server_name}: {e}\"\n                                await logger.awarning(msg)\n                                cached_tools = None\n\n                # Clear tools when cache is disabled OR when we don't have cached tools\n                # This ensures fresh tools are fetched after database edits\n                if not cached_tools or not use_cache:\n                    self.tools = []  # Clear previous tools to force refresh\n\n                # Clear previous tool inputs if:\n                # 1. Server actually changed\n                # 2. Cache is disabled (meaning tool list will be refreshed)\n                if server_changed or not use_cache:\n                    self.remove_non_default_keys(build_config)\n\n                # Only show the tool dropdown if not in tool_mode\n                if not is_in_tool_mode:\n                    build_config[\"tool\"][\"show\"] = True\n                    if cached_tools:\n                        # Use cached tools to populate options immediately\n                        build_config[\"tool\"][\"options\"] = [tool.name for tool in cached_tools]\n                        build_config[\"tool\"][\"placeholder\"] = \"Select a tool\"\n                    else:\n                        # Show loading state only when we need to fetch tools\n                        build_config[\"tool\"][\"placeholder\"] = \"Loading tools...\"\n                        build_config[\"tool\"][\"options\"] = []\n                    # Force a value refresh when:\n                    # 1. Server changed\n                    # 2. We don't have cached tools\n                    # 3. Cache is disabled (to force refresh on config changes)\n                    if server_changed or not cached_tools or not use_cache:\n                        build_config[\"tool\"][\"value\"] = uuid.uuid4()\n                else:\n                    # Keep the tool dropdown hidden if in tool_mode\n                    self._not_load_actions = True\n                    build_config[\"tool\"][\"show\"] = False\n\n            elif field_name == \"tool_mode\":\n                build_config[\"tool\"][\"placeholder\"] = \"\"\n                build_config[\"tool\"][\"show\"] = not bool(field_value) and bool(build_config[\"mcp_server\"])\n                self.remove_non_default_keys(build_config)\n                self.tool = build_config[\"tool\"][\"value\"]\n                if field_value:\n                    self._not_load_actions = True\n                else:\n                    build_config[\"tool\"][\"value\"] = uuid.uuid4()\n                    build_config[\"tool\"][\"options\"] = []\n                    build_config[\"tool\"][\"show\"] = True\n                    build_config[\"tool\"][\"placeholder\"] = \"Loading tools...\"\n            elif field_name == \"tools_metadata\":\n                self._not_load_actions = False\n\n        except Exception as e:\n            msg = f\"Error in update_build_config: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n        else:\n            return build_config\n\n    def get_inputs_for_all_tools(self, tools: list) -> dict:\n        \"\"\"Get input schemas for all tools.\"\"\"\n        inputs = {}\n        for tool in tools:\n            if not tool or not hasattr(tool, \"name\"):\n                continue\n            try:\n                flat_schema = flatten_schema(tool.args_schema.schema())\n                input_schema = create_input_schema_from_json_schema(flat_schema)\n                langflow_inputs = schema_to_langflow_inputs(input_schema)\n                inputs[tool.name] = langflow_inputs\n            except (AttributeError, ValueError, TypeError, KeyError) as e:\n                msg = f\"Error getting inputs for tool {getattr(tool, 'name', 'unknown')}: {e!s}\"\n                logger.exception(msg)\n                continue\n        return inputs\n\n    def remove_non_default_keys(self, build_config: dict) -> None:\n        \"\"\"Remove non-default keys from the build config.\"\"\"\n        for key in list(build_config.keys()):\n            if key not in self.default_keys:\n                build_config.pop(key)\n\n    async def _update_tool_config(self, build_config: dict, tool_name: str) -> None:\n        \"\"\"Update tool configuration with proper error handling.\"\"\"\n        if not self.tools:\n            self.tools, build_config[\"mcp_server\"][\"value\"] = await self.update_tool_list()\n\n        if not tool_name:\n            return\n\n        tool_obj = next((tool for tool in self.tools if tool.name == tool_name), None)\n        if not tool_obj:\n            msg = f\"Tool {tool_name} not found in available tools: {self.tools}\"\n            self.remove_non_default_keys(build_config)\n            build_config[\"tool\"][\"value\"] = \"\"\n            await logger.awarning(msg)\n            return\n\n        try:\n            # Store current values before removing inputs (only for the current tool)\n            current_values = {}\n            for key, value in build_config.items():\n                if key not in self.default_keys and isinstance(value, dict) and \"value\" in value:\n                    current_values[key] = value[\"value\"]\n\n            # Remove ALL non-default keys (all previous tool inputs)\n            self.remove_non_default_keys(build_config)\n\n            # Get and validate new inputs for the selected tool\n            self.schema_inputs = await self._validate_schema_inputs(tool_obj)\n            if not self.schema_inputs:\n                msg = f\"No input parameters to configure for tool '{tool_name}'\"\n                await logger.ainfo(msg)\n                return\n\n            # Add new inputs to build config for the selected tool only\n            for schema_input in self.schema_inputs:\n                if not schema_input or not hasattr(schema_input, \"name\"):\n                    msg = \"Invalid schema input detected, skipping\"\n                    await logger.awarning(msg)\n                    continue\n\n                try:\n                    name = schema_input.name\n                    input_dict = schema_input.to_dict()\n                    input_dict.setdefault(\"value\", None)\n                    input_dict.setdefault(\"required\", True)\n\n                    build_config[name] = input_dict\n\n                    # Preserve existing value if the parameter name exists in current_values\n                    if name in current_values:\n                        build_config[name][\"value\"] = current_values[name]\n\n                except (AttributeError, KeyError, TypeError) as e:\n                    msg = f\"Error processing schema input {schema_input}: {e!s}\"\n                    await logger.aexception(msg)\n                    continue\n        except ValueError as e:\n            msg = f\"Schema validation error for tool {tool_name}: {e!s}\"\n            await logger.aexception(msg)\n            self.schema_inputs = []\n            return\n        except (AttributeError, KeyError, TypeError) as e:\n            msg = f\"Error updating tool config: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n\n    async def build_output(self) -> DataFrame:\n        \"\"\"Build output with improved error handling and validation.\"\"\"\n        try:\n            self.tools, _ = await self.update_tool_list()\n            if self.tool != \"\":\n                # Set session context for persistent MCP sessions using Langflow session ID\n                session_context = self._get_session_context()\n                if session_context:\n                    self.stdio_client.set_session_context(session_context)\n                    self.streamable_http_client.set_session_context(session_context)\n                exec_tool = self._tool_cache[self.tool]\n                tool_args = self.get_inputs_for_all_tools(self.tools)[self.tool]\n                kwargs = {}\n                for arg in tool_args:\n                    value = getattr(self, arg.name, None)\n                    if value is not None:\n                        if isinstance(value, Message):\n                            kwargs[arg.name] = value.text\n                        else:\n                            kwargs[arg.name] = value\n\n                unflattened_kwargs = maybe_unflatten_dict(kwargs)\n\n                output = await exec_tool.coroutine(**unflattened_kwargs)\n                tool_content = []\n                for item in output.content:\n                    item_dict = item.model_dump()\n                    item_dict = self.process_output_item(item_dict)\n                    tool_content.append(item_dict)\n\n                if isinstance(tool_content, list) and all(isinstance(x, dict) for x in tool_content):\n                    return DataFrame(tool_content)\n                return DataFrame(data=tool_content)\n            return DataFrame(data=[{\"error\": \"You must select a tool\"}])\n        except Exception as e:\n            msg = f\"Error in build_output: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n\n    def process_output_item(self, item_dict):\n        \"\"\"Process the output of a tool.\"\"\"\n        if item_dict.get(\"type\") == \"text\":\n            text = item_dict.get(\"text\")\n            try:\n                parsed = json.loads(text)\n                # Ensure we always return a dictionary for DataFrame compatibility\n                if isinstance(parsed, dict):\n                    return parsed\n                # Wrap non-dict parsed values in a dictionary\n                return {\"text\": text, \"parsed_value\": parsed, \"type\": \"text\"}  # noqa: TRY300\n            except json.JSONDecodeError:\n                return item_dict\n        return item_dict\n\n    def _get_session_context(self) -> str | None:\n        \"\"\"Get the Langflow session ID for MCP session caching.\"\"\"\n        # Try to get session ID from the component's execution context\n        if hasattr(self, \"graph\") and hasattr(self.graph, \"session_id\"):\n            session_id = self.graph.session_id\n            # Include server name to ensure different servers get different sessions\n            server_name = \"\"\n            mcp_server = getattr(self, \"mcp_server\", None)\n            if isinstance(mcp_server, dict):\n                server_name = mcp_server.get(\"name\", \"\")\n            elif mcp_server:\n                server_name = str(mcp_server)\n            return f\"{session_id}_{server_name}\" if session_id else None\n        return None\n\n    async def _get_tools(self):\n        \"\"\"Get cached tools or update if necessary.\"\"\"\n        mcp_server = getattr(self, \"mcp_server\", None)\n        if not self._not_load_actions:\n            tools, _ = await self.update_tool_list(mcp_server)\n            return tools\n        return []\n"
              },
              "is_refresh": false,
              "mcp_server": {
                "_input_type": "McpInput",
                "advanced": false,
                "display_name": "MCP Server",
                "dynamic": false,
                "info": "Select the MCP Server that will be used by this component",
                "load_from_db": false,
                "name": "mcp_server",
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "mcp",
                "value": {
                  "config": {
                    "url": "http://localhost:8111/sse",
                    "verify_ssl": true
                  },
                  "name": "crm"
                }
              },
              "tool": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Tool",
                "dynamic": false,
                "external_options": {},
                "info": "Select the tool to execute",
                "name": "tool",
                "options": [
                  "get_accounts_accounts",
                  "create_account_accounts",
                  "get_account_accounts",
                  "update_account_accounts",
                  "delete_account_accounts",
                  "get_leads_leads",
                  "create_lead_leads",
                  "get_lead_leads",
                  "update_lead_leads",
                  "delete_lead_leads",
                  "get_contacts_contacts",
                  "create_contact_contacts",
                  "get_contact_contacts",
                  "update_contact_contacts",
                  "delete_contact_contacts",
                  "get_opportunities_opportunities",
                  "create_opportunity_opportunities",
                  "get_opportunity_opportunities",
                  "update_opportunity_opportunities",
                  "delete_opportunity_opportunities"
                ],
                "options_metadata": [],
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": true,
                "show": false,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": ""
              },
              "tool_placeholder": {
                "_input_type": "MessageTextInput",
                "advanced": false,
                "display_name": "Tool Placeholder",
                "dynamic": false,
                "info": "Placeholder for the tool",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "tool_placeholder",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "tools_metadata": {
                "_input_type": "ToolsInput",
                "advanced": false,
                "display_name": "Actions",
                "dynamic": false,
                "info": "Modify tool names and descriptions to help agents understand when to use each tool.",
                "is_list": true,
                "list_add_label": "Add More",
                "name": "tools_metadata",
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "tools",
                "value": [
                  {
                    "args": {
                      "limit": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 20,
                        "title": "Limit"
                      },
                      "skip": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 0,
                        "title": "Skip"
                      },
                      "state": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "description": "Filter accounts by state",
                        "title": "State"
                      }
                    },
                    "description": "Get Accounts\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n- **state**: Filter accounts by state\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Accounts\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n- **state**: Filter accounts by state\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_accounts_accounts",
                    "name": "get_accounts_accounts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_accounts_accounts"
                    ]
                  },
                  {
                    "args": {
                      "address": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Address"
                      },
                      "annual_revenue": {
                        "anyOf": [
                          {
                            "type": "number"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Annual Revenue"
                      },
                      "city": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "City"
                      },
                      "country": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Country"
                      },
                      "employee_count": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Employee Count"
                      },
                      "industry": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Industry"
                      },
                      "name": {
                        "title": "Name",
                        "type": "string"
                      },
                      "phone": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Phone"
                      },
                      "region": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Region"
                      },
                      "state": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "State"
                      },
                      "website": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Website"
                      }
                    },
                    "description": "Create Account\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"industry\": \"unknown_type\",\n  \"website\": \"unknown_type\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Create Account\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"industry\": \"unknown_type\",\n  \"website\": \"unknown_type\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "create_account_accounts",
                    "name": "create_account_accounts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "create_account_accounts"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "title": "Account Id",
                        "type": "integer"
                      }
                    },
                    "description": "Get Account\n\n\n**Path Parameters:**\n\n- **account_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"industry\": \"unknown_type\",\n  \"website\": \"unknown_type\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Account\n\n\n**Path Parameters:**\n\n- **account_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"industry\": \"unknown_type\",\n  \"website\": \"unknown_type\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_account_accounts",
                    "name": "get_account_accounts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_account_accounts"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "title": "Account Id",
                        "type": "integer"
                      },
                      "address": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Address"
                      },
                      "annual_revenue": {
                        "anyOf": [
                          {
                            "type": "number"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Annual Revenue"
                      },
                      "city": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "City"
                      },
                      "country": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Country"
                      },
                      "email": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Email"
                      },
                      "employee_count": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Employee Count"
                      },
                      "industry": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Industry"
                      },
                      "name": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Name"
                      },
                      "phone": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Phone"
                      },
                      "region": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Region"
                      },
                      "state": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "State"
                      },
                      "website": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Website"
                      }
                    },
                    "description": "Update Account\n\n\n**Path Parameters:**\n\n- **account_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"industry\": \"unknown_type\",\n  \"website\": \"unknown_type\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Update Account\n\n\n**Path Parameters:**\n\n- **account_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"industry\": \"unknown_type\",\n  \"website\": \"unknown_type\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "update_account_accounts",
                    "name": "update_account_accounts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "update_account_accounts"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "title": "Account Id",
                        "type": "integer"
                      }
                    },
                    "description": "Delete Account\n\n\n**Path Parameters:**\n\n- **account_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Delete Account\n\n\n**Path Parameters:**\n\n- **account_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "delete_account_accounts",
                    "name": "delete_account_accounts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "delete_account_accounts"
                    ]
                  },
                  {
                    "args": {
                      "limit": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 20,
                        "title": "Limit"
                      },
                      "skip": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 0,
                        "title": "Skip"
                      }
                    },
                    "description": "Get Leads\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Leads\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_leads_leads",
                    "name": "get_leads_leads",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_leads_leads"
                    ]
                  },
                  {
                    "args": {
                      "company": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Company"
                      },
                      "email": {
                        "title": "Email",
                        "type": "string"
                      },
                      "first_name": {
                        "title": "First Name",
                        "type": "string"
                      },
                      "industry": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Industry"
                      },
                      "job_title": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Job Title"
                      },
                      "last_name": {
                        "title": "Last Name",
                        "type": "string"
                      },
                      "notes": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Notes"
                      },
                      "phone": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Phone"
                      },
                      "score": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 0,
                        "title": "Score"
                      },
                      "source": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Source"
                      },
                      "status": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": "new",
                        "title": "Status"
                      }
                    },
                    "description": "Create Lead\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Create Lead\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "create_lead_leads",
                    "name": "create_lead_leads",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "create_lead_leads"
                    ]
                  },
                  {
                    "args": {
                      "lead_id": {
                        "title": "Lead Id",
                        "type": "integer"
                      }
                    },
                    "description": "Get Lead\n\n\n**Path Parameters:**\n\n- **lead_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Lead\n\n\n**Path Parameters:**\n\n- **lead_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_lead_leads",
                    "name": "get_lead_leads",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_lead_leads"
                    ]
                  },
                  {
                    "args": {
                      "company": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Company"
                      },
                      "email": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Email"
                      },
                      "first_name": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "First Name"
                      },
                      "industry": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Industry"
                      },
                      "job_title": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Job Title"
                      },
                      "last_name": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Last Name"
                      },
                      "lead_id": {
                        "title": "Lead Id",
                        "type": "integer"
                      },
                      "notes": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Notes"
                      },
                      "phone": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Phone"
                      },
                      "score": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Score"
                      },
                      "source": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Source"
                      },
                      "status": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Status"
                      }
                    },
                    "description": "Update Lead\n\n\n**Path Parameters:**\n\n- **lead_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Update Lead\n\n\n**Path Parameters:**\n\n- **lead_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "update_lead_leads",
                    "name": "update_lead_leads",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "update_lead_leads"
                    ]
                  },
                  {
                    "args": {
                      "lead_id": {
                        "title": "Lead Id",
                        "type": "integer"
                      }
                    },
                    "description": "Delete Lead\n\n\n**Path Parameters:**\n\n- **lead_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Delete Lead\n\n\n**Path Parameters:**\n\n- **lead_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "delete_lead_leads",
                    "name": "delete_lead_leads",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "delete_lead_leads"
                    ]
                  },
                  {
                    "args": {
                      "email": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "description": "Filter contacts by email",
                        "title": "Email"
                      },
                      "limit": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 300,
                        "title": "Limit"
                      },
                      "skip": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 0,
                        "title": "Skip"
                      }
                    },
                    "description": "Get Contacts\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n- **email**: Filter contacts by email\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Contacts\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n- **email**: Filter contacts by email\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_contacts_contacts",
                    "name": "get_contacts_contacts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_contacts_contacts"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "title": "Account Id",
                        "type": "integer"
                      },
                      "department": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Department"
                      },
                      "email": {
                        "title": "Email",
                        "type": "string"
                      },
                      "first_name": {
                        "title": "First Name",
                        "type": "string"
                      },
                      "is_primary": {
                        "anyOf": [
                          {
                            "type": "boolean"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": false,
                        "title": "Is Primary"
                      },
                      "job_title": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Job Title"
                      },
                      "last_name": {
                        "title": "Last Name",
                        "type": "string"
                      },
                      "phone": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Phone"
                      }
                    },
                    "description": "Create Contact\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Create Contact\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "create_contact_contacts",
                    "name": "create_contact_contacts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "create_contact_contacts"
                    ]
                  },
                  {
                    "args": {
                      "contact_id": {
                        "title": "Contact Id",
                        "type": "integer"
                      }
                    },
                    "description": "Get Contact\n\n\n**Path Parameters:**\n\n- **contact_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Contact\n\n\n**Path Parameters:**\n\n- **contact_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_contact_contacts",
                    "name": "get_contact_contacts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_contact_contacts"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Account Id"
                      },
                      "contact_id": {
                        "title": "Contact Id",
                        "type": "integer"
                      },
                      "department": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Department"
                      },
                      "email": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Email"
                      },
                      "first_name": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "First Name"
                      },
                      "is_primary": {
                        "anyOf": [
                          {
                            "type": "boolean"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Is Primary"
                      },
                      "job_title": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Job Title"
                      },
                      "last_name": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Last Name"
                      },
                      "phone": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Phone"
                      }
                    },
                    "description": "Update Contact\n\n\n**Path Parameters:**\n\n- **contact_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Update Contact\n\n\n**Path Parameters:**\n\n- **contact_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"first_name\": \"string\",\n  \"last_name\": \"string\",\n  \"email\": \"user@example.com\",\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "update_contact_contacts",
                    "name": "update_contact_contacts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "update_contact_contacts"
                    ]
                  },
                  {
                    "args": {
                      "contact_id": {
                        "title": "Contact Id",
                        "type": "integer"
                      }
                    },
                    "description": "Delete Contact\n\n\n**Path Parameters:**\n\n- **contact_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Delete Contact\n\n\n**Path Parameters:**\n\n- **contact_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "delete_contact_contacts",
                    "name": "delete_contact_contacts",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "delete_contact_contacts"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "description": "Filter opportunities by account ID",
                        "title": "Account Id"
                      },
                      "limit": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 300,
                        "title": "Limit"
                      },
                      "skip": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 0,
                        "title": "Skip"
                      }
                    },
                    "description": "Get Opportunities\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n- **account_id**: Filter opportunities by account ID\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Opportunities\n\n\n**Query Parameters:**\n\n- **skip**: No description.\n\n- **limit**: No description.\n\n- **account_id**: Filter opportunities by account ID\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"items\": [\n    \"unknown_type\"\n  ],\n  \"total\": 1,\n  \"page\": 1,\n  \"pages\": 1,\n  \"per_page\": 1\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_opportunities_opportunities",
                    "name": "get_opportunities_opportunities",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_opportunities_opportunities"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "title": "Account Id",
                        "type": "integer"
                      },
                      "close_date": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Close Date"
                      },
                      "currency": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": "USD",
                        "title": "Currency"
                      },
                      "description": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Description"
                      },
                      "name": {
                        "title": "Name",
                        "type": "string"
                      },
                      "probability": {
                        "anyOf": [
                          {
                            "type": "number"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": 0,
                        "title": "Probability"
                      },
                      "stage": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": "prospecting",
                        "title": "Stage"
                      },
                      "value": {
                        "title": "Value",
                        "type": "number"
                      }
                    },
                    "description": "Create Opportunity\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"description\": \"unknown_type\",\n  \"value\": 1.5,\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Create Opportunity\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"description\": \"unknown_type\",\n  \"value\": 1.5,\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "create_opportunity_opportunities",
                    "name": "create_opportunity_opportunities",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "create_opportunity_opportunities"
                    ]
                  },
                  {
                    "args": {
                      "opportunity_id": {
                        "title": "Opportunity Id",
                        "type": "integer"
                      }
                    },
                    "description": "Get Opportunity\n\n\n**Path Parameters:**\n\n- **opportunity_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"description\": \"unknown_type\",\n  \"value\": 1.5,\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Get Opportunity\n\n\n**Path Parameters:**\n\n- **opportunity_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"description\": \"unknown_type\",\n  \"value\": 1.5,\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "get_opportunity_opportunities",
                    "name": "get_opportunity_opportunities",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_opportunity_opportunities"
                    ]
                  },
                  {
                    "args": {
                      "account_id": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Account Id"
                      },
                      "close_date": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Close Date"
                      },
                      "currency": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Currency"
                      },
                      "description": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Description"
                      },
                      "name": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Name"
                      },
                      "opportunity_id": {
                        "title": "Opportunity Id",
                        "type": "integer"
                      },
                      "probability": {
                        "anyOf": [
                          {
                            "type": "number"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Probability"
                      },
                      "stage": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Stage"
                      },
                      "value": {
                        "anyOf": [
                          {
                            "type": "number"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Value"
                      }
                    },
                    "description": "Update Opportunity\n\n\n**Path Parameters:**\n\n- **opportunity_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"description\": \"unknown_type\",\n  \"value\": 1.5,\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Update Opportunity\n\n\n**Path Parameters:**\n\n- **opportunity_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"name\": \"string\",\n  \"description\": \"unknown_type\",\n  \"value\": 1.5,\n  \"id\": 1,\n  \"account_id\": 1,\n  \"created_at\": \"2024-01-01T12:00:00Z\"\n}\n```\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "update_opportunity_opportunities",
                    "name": "update_opportunity_opportunities",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "update_opportunity_opportunities"
                    ]
                  },
                  {
                    "args": {
                      "opportunity_id": {
                        "title": "Opportunity Id",
                        "type": "integer"
                      }
                    },
                    "description": "Delete Opportunity\n\n\n**Path Parameters:**\n\n- **opportunity_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_description": "Delete Opportunity\n\n\n**Path Parameters:**\n\n- **opportunity_id** (Required): No description.\n\n\n**Responses:**\n\n- **200** (Success): Successful Response\n  - Content-Type: `application/json`\n\n- **422**: Validation Error\n  - Content-Type: `application/json`\n\n  - **Response Properties:**\n\n  - **Example:**\n```json\n{\n  \"detail\": [\n    \"unknown_type\"\n  ]\n}\n```\n",
                    "display_name": "delete_opportunity_opportunities",
                    "name": "delete_opportunity_opportunities",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "delete_opportunity_opportunities"
                    ]
                  }
                ]
              },
              "use_cache": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Use Cached Server",
                "dynamic": false,
                "info": "Enable caching of MCP Server and tools to improve performance. Disable to always fetch fresh tools and server updates.",
                "list": false,
                "list_add_label": "Add More",
                "name": "use_cache",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": false
              },
              "verify_ssl": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Verify SSL Certificate",
                "dynamic": false,
                "info": "Enable SSL certificate verification for HTTPS connections. Disable only for development/testing with self-signed certificates.",
                "list": false,
                "list_add_label": "Add More",
                "name": "verify_ssl",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              }
            },
            "tool_mode": true
          },
          "showNode": true,
          "type": "MCPTools"
        },
        "dragging": false,
        "id": "MCPTools-YTBps",
        "measured": {
          "height": 367,
          "width": 320
        },
        "position": {
          "x": 702.9308078232846,
          "y": 68.58235352980056
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "MCPTools-6jiqJ",
          "node": {
            "base_classes": [
              "DataFrame"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Connect to an MCP server to use its tools.",
            "display_name": "MCP Tools",
            "documentation": "https://docs.langflow.org/mcp-tools",
            "edited": false,
            "field_order": [
              "mcp_server",
              "use_cache",
              "verify_ssl",
              "tool",
              "tool_placeholder"
            ],
            "frozen": false,
            "icon": "Mcp",
            "last_updated": "2025-12-18T10:50:05.653Z",
            "legacy": false,
            "lf_version": "1.7.0",
            "metadata": {
              "code_hash": "39187e27d938",
              "dependencies": {
                "dependencies": [
                  {
                    "name": "langchain_core",
                    "version": "0.3.80"
                  },
                  {
                    "name": "lfx",
                    "version": null
                  },
                  {
                    "name": "langflow",
                    "version": null
                  }
                ],
                "total_dependencies": 3
              },
              "module": "custom_components.mcp_tools"
            },
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Toolset",
                "group_outputs": false,
                "hidden": null,
                "loop_types": null,
                "method": "to_toolkit",
                "name": "component_as_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_frontend_node_flow_id": {
                "value": "af63ae2e-2804-4ab5-9259-4e337a09a401"
              },
              "_frontend_node_folder_id": {
                "value": "9d4e6e89-4355-4367-8927-de9e2800dfeb"
              },
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from __future__ import annotations\n\nimport asyncio\nimport json\nimport uuid\n\nfrom langchain_core.tools import StructuredTool  # noqa: TC002\n\nfrom lfx.base.agents.utils import maybe_unflatten_dict, safe_cache_get, safe_cache_set\nfrom lfx.base.mcp.util import (\n    MCPStdioClient,\n    MCPStreamableHttpClient,\n    create_input_schema_from_json_schema,\n    update_tools,\n)\nfrom lfx.custom.custom_component.component_with_cache import ComponentWithCache\nfrom lfx.inputs.inputs import InputTypes  # noqa: TC001\nfrom lfx.io import BoolInput, DropdownInput, McpInput, MessageTextInput, Output\nfrom lfx.io.schema import flatten_schema, schema_to_langflow_inputs\nfrom lfx.log.logger import logger\nfrom lfx.schema.dataframe import DataFrame\nfrom lfx.schema.message import Message\nfrom lfx.services.deps import get_settings_service, get_storage_service, session_scope\n\n\ndef resolve_mcp_config(\n    server_name: str,  # noqa: ARG001\n    server_config_from_value: dict | None,\n    server_config_from_db: dict | None,\n) -> dict | None:\n    \"\"\"Resolve MCP server config with proper precedence.\n\n    Resolves the configuration for an MCP server with the following precedence:\n    1. Database config (takes priority) - ensures edits are reflected\n    2. Config from value/tweaks (fallback) - allows REST API to provide config for new servers\n\n    Args:\n        server_name: Name of the MCP server\n        server_config_from_value: Config provided via value/tweaks (optional)\n        server_config_from_db: Config from database (optional)\n\n    Returns:\n        Final config to use (DB takes priority, falls back to value)\n        Returns None if no config found in either location\n    \"\"\"\n    if server_config_from_db:\n        return server_config_from_db\n    return server_config_from_value\n\n\nclass MCPToolsComponent(ComponentWithCache):\n    schema_inputs: list = []\n    tools: list[StructuredTool] = []\n    _not_load_actions: bool = False\n    _tool_cache: dict = {}\n    _last_selected_server: str | None = None  # Cache for the last selected server\n\n    def __init__(self, **data) -> None:\n        super().__init__(**data)\n        # Initialize cache keys to avoid CacheMiss when accessing them\n        self._ensure_cache_structure()\n\n        # Initialize clients with access to the component cache\n        self.stdio_client: MCPStdioClient = MCPStdioClient(component_cache=self._shared_component_cache)\n        self.streamable_http_client: MCPStreamableHttpClient = MCPStreamableHttpClient(\n            component_cache=self._shared_component_cache\n        )\n\n    def _ensure_cache_structure(self):\n        \"\"\"Ensure the cache has the required structure.\"\"\"\n        # Check if servers key exists and is not CacheMiss\n        servers_value = safe_cache_get(self._shared_component_cache, \"servers\")\n        if servers_value is None:\n            safe_cache_set(self._shared_component_cache, \"servers\", {})\n\n        # Check if last_selected_server key exists and is not CacheMiss\n        last_server_value = safe_cache_get(self._shared_component_cache, \"last_selected_server\")\n        if last_server_value is None:\n            safe_cache_set(self._shared_component_cache, \"last_selected_server\", \"\")\n\n    default_keys: list[str] = [\n        \"code\",\n        \"_type\",\n        \"tool_mode\",\n        \"tool_placeholder\",\n        \"mcp_server\",\n        \"tool\",\n        \"use_cache\",\n        \"verify_ssl\",\n    ]\n\n    display_name = \"MCP Tools\"\n    description = \"Connect to an MCP server to use its tools.\"\n    documentation: str = \"https://docs.langflow.org/mcp-tools\"\n    icon = \"Mcp\"\n    name = \"MCPTools\"\n\n    inputs = [\n        McpInput(\n            name=\"mcp_server\",\n            display_name=\"MCP Server\",\n            info=\"Select the MCP Server that will be used by this component\",\n            real_time_refresh=True,\n        ),\n        BoolInput(\n            name=\"use_cache\",\n            display_name=\"Use Cached Server\",\n            info=(\n                \"Enable caching of MCP Server and tools to improve performance. \"\n                \"Disable to always fetch fresh tools and server updates.\"\n            ),\n            value=False,\n            advanced=True,\n        ),\n        BoolInput(\n            name=\"verify_ssl\",\n            display_name=\"Verify SSL Certificate\",\n            info=(\n                \"Enable SSL certificate verification for HTTPS connections. \"\n                \"Disable only for development/testing with self-signed certificates.\"\n            ),\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"tool\",\n            display_name=\"Tool\",\n            options=[],\n            value=\"\",\n            info=\"Select the tool to execute\",\n            show=False,\n            required=True,\n            real_time_refresh=True,\n        ),\n        MessageTextInput(\n            name=\"tool_placeholder\",\n            display_name=\"Tool Placeholder\",\n            info=\"Placeholder for the tool\",\n            value=\"\",\n            show=False,\n            tool_mode=False,\n        ),\n    ]\n\n    outputs = [\n        Output(display_name=\"Response\", name=\"response\", method=\"build_output\"),\n    ]\n\n    async def _validate_schema_inputs(self, tool_obj) -> list[InputTypes]:\n        \"\"\"Validate and process schema inputs for a tool.\"\"\"\n        try:\n            if not tool_obj or not hasattr(tool_obj, \"args_schema\"):\n                msg = \"Invalid tool object or missing input schema\"\n                raise ValueError(msg)\n\n            flat_schema = flatten_schema(tool_obj.args_schema.schema())\n            input_schema = create_input_schema_from_json_schema(flat_schema)\n            if not input_schema:\n                msg = f\"Empty input schema for tool '{tool_obj.name}'\"\n                raise ValueError(msg)\n\n            schema_inputs = schema_to_langflow_inputs(input_schema)\n            if not schema_inputs:\n                msg = f\"No input parameters defined for tool '{tool_obj.name}'\"\n                await logger.awarning(msg)\n                return []\n\n        except Exception as e:\n            msg = f\"Error validating schema inputs: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n        else:\n            return schema_inputs\n\n    async def update_tool_list(self, mcp_server_value=None):\n        # Accepts mcp_server_value as dict {name, config} or uses self.mcp_server\n        mcp_server = mcp_server_value if mcp_server_value is not None else getattr(self, \"mcp_server\", None)\n        server_name = None\n        server_config_from_value = None\n        if isinstance(mcp_server, dict):\n            server_name = mcp_server.get(\"name\")\n            server_config_from_value = mcp_server.get(\"config\")\n        else:\n            server_name = mcp_server\n        if not server_name:\n            self.tools = []\n            return [], {\"name\": server_name, \"config\": server_config_from_value}\n\n        # Check if caching is enabled, default to False\n        use_cache = getattr(self, \"use_cache\", False)\n\n        # Use shared cache if available and caching is enabled\n        cached = None\n        if use_cache:\n            servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n            cached = servers_cache.get(server_name) if isinstance(servers_cache, dict) else None\n\n        if cached is not None:\n            try:\n                self.tools = cached[\"tools\"]\n                self.tool_names = cached[\"tool_names\"]\n                self._tool_cache = cached[\"tool_cache\"]\n                server_config_from_value = cached[\"config\"]\n            except (TypeError, KeyError, AttributeError) as e:\n                # Handle corrupted cache data by clearing it and continuing to fetch fresh tools\n                msg = f\"Unable to use cached data for MCP Server{server_name}: {e}\"\n                await logger.awarning(msg)\n                # Clear the corrupted cache entry\n                current_servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                if isinstance(current_servers_cache, dict) and server_name in current_servers_cache:\n                    current_servers_cache.pop(server_name)\n                    safe_cache_set(self._shared_component_cache, \"servers\", current_servers_cache)\n            else:\n                return self.tools, {\"name\": server_name, \"config\": server_config_from_value}\n\n        try:\n            # Try to fetch from database first to ensure we have the latest config\n            # This ensures database updates (like editing a server) take effect\n            try:\n                from langflow.api.v2.mcp import get_server\n                from langflow.services.database.models.user.crud import get_user_by_id\n            except ImportError as e:\n                msg = (\n                    \"Langflow MCP server functionality is not available. \"\n                    \"This feature requires the full Langflow installation.\"\n                )\n                raise ImportError(msg) from e\n\n            server_config_from_db = None\n            async with session_scope() as db:\n                if not self.user_id:\n                    msg = \"User ID is required for fetching MCP tools.\"\n                    raise ValueError(msg)\n                current_user = await get_user_by_id(db, self.user_id)\n\n                # Try to get server config from DB/API\n                server_config_from_db = await get_server(\n                    server_name,\n                    current_user,\n                    db,\n                    storage_service=get_storage_service(),\n                    settings_service=get_settings_service(),\n                )\n\n            # Resolve config with proper precedence: DB takes priority, falls back to value\n            server_config = resolve_mcp_config(\n                server_name=server_name,\n                server_config_from_value=server_config_from_value,\n                server_config_from_db=server_config_from_db,\n            )\n\n            if not server_config:\n                self.tools = []\n                return [], {\"name\": server_name, \"config\": server_config}\n\n            # Add verify_ssl option to server config if not present\n            if \"verify_ssl\" not in server_config:\n                verify_ssl = getattr(self, \"verify_ssl\", True)\n                server_config[\"verify_ssl\"] = verify_ssl\n\n            _, tool_list, tool_cache = await update_tools(\n                server_name=server_name,\n                server_config=server_config,\n                mcp_stdio_client=self.stdio_client,\n                mcp_streamable_http_client=self.streamable_http_client,\n            )\n\n            self.tool_names = [tool.name for tool in tool_list if hasattr(tool, \"name\")]\n            self._tool_cache = tool_cache\n            self.tools = tool_list\n\n            # Cache the result only if caching is enabled\n            if use_cache:\n                cache_data = {\n                    \"tools\": tool_list,\n                    \"tool_names\": self.tool_names,\n                    \"tool_cache\": tool_cache,\n                    \"config\": server_config,\n                }\n\n                # Safely update the servers cache\n                current_servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                if isinstance(current_servers_cache, dict):\n                    current_servers_cache[server_name] = cache_data\n                    safe_cache_set(self._shared_component_cache, \"servers\", current_servers_cache)\n\n        except (TimeoutError, asyncio.TimeoutError) as e:\n            msg = f\"Timeout updating tool list: {e!s}\"\n            await logger.aexception(msg)\n            raise TimeoutError(msg) from e\n        except Exception as e:\n            msg = f\"Error updating tool list: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n        else:\n            return tool_list, {\"name\": server_name, \"config\": server_config}\n\n    async def update_build_config(self, build_config: dict, field_value: str, field_name: str | None = None) -> dict:\n        \"\"\"Toggle the visibility of connection-specific fields based on the selected mode.\"\"\"\n        try:\n            if field_name == \"tool\":\n                try:\n                    # Always refresh tools when cache is disabled, or when tools list is empty\n                    # This ensures database edits are reflected immediately when cache is disabled\n                    use_cache = getattr(self, \"use_cache\", False)\n                    if len(self.tools) == 0 or not use_cache:\n                        try:\n                            self.tools, build_config[\"mcp_server\"][\"value\"] = await self.update_tool_list()\n                            build_config[\"tool\"][\"options\"] = [tool.name for tool in self.tools]\n                            build_config[\"tool\"][\"placeholder\"] = \"Select a tool\"\n                        except (TimeoutError, asyncio.TimeoutError) as e:\n                            msg = f\"Timeout updating tool list: {e!s}\"\n                            await logger.aexception(msg)\n                            if not build_config[\"tools_metadata\"][\"show\"]:\n                                build_config[\"tool\"][\"show\"] = True\n                                build_config[\"tool\"][\"options\"] = []\n                                build_config[\"tool\"][\"value\"] = \"\"\n                                build_config[\"tool\"][\"placeholder\"] = \"Timeout on MCP server\"\n                            else:\n                                build_config[\"tool\"][\"show\"] = False\n                        except ValueError:\n                            if not build_config[\"tools_metadata\"][\"show\"]:\n                                build_config[\"tool\"][\"show\"] = True\n                                build_config[\"tool\"][\"options\"] = []\n                                build_config[\"tool\"][\"value\"] = \"\"\n                                build_config[\"tool\"][\"placeholder\"] = \"Error on MCP Server\"\n                            else:\n                                build_config[\"tool\"][\"show\"] = False\n\n                    if field_value == \"\":\n                        return build_config\n                    tool_obj = None\n                    for tool in self.tools:\n                        if tool.name == field_value:\n                            tool_obj = tool\n                            break\n                    if tool_obj is None:\n                        msg = f\"Tool {field_value} not found in available tools: {self.tools}\"\n                        await logger.awarning(msg)\n                        return build_config\n                    await self._update_tool_config(build_config, field_value)\n                except Exception as e:\n                    build_config[\"tool\"][\"options\"] = []\n                    msg = f\"Failed to update tools: {e!s}\"\n                    raise ValueError(msg) from e\n                else:\n                    return build_config\n            elif field_name == \"mcp_server\":\n                if not field_value:\n                    build_config[\"tool\"][\"show\"] = False\n                    build_config[\"tool\"][\"options\"] = []\n                    build_config[\"tool\"][\"value\"] = \"\"\n                    build_config[\"tool\"][\"placeholder\"] = \"\"\n                    build_config[\"tool_placeholder\"][\"tool_mode\"] = False\n                    self.remove_non_default_keys(build_config)\n                    return build_config\n\n                build_config[\"tool_placeholder\"][\"tool_mode\"] = True\n\n                current_server_name = field_value.get(\"name\") if isinstance(field_value, dict) else field_value\n                _last_selected_server = safe_cache_get(self._shared_component_cache, \"last_selected_server\", \"\")\n                server_changed = current_server_name != _last_selected_server\n\n                # Determine if \"Tool Mode\" is active by checking if the tool dropdown is hidden.\n                is_in_tool_mode = build_config[\"tools_metadata\"][\"show\"]\n\n                # Get use_cache setting to determine if we should use cached data\n                use_cache = getattr(self, \"use_cache\", False)\n\n                # Fast path: if server didn't change and we already have options, keep them as-is\n                # BUT only if caching is enabled or we're in tool mode\n                existing_options = build_config.get(\"tool\", {}).get(\"options\") or []\n                if not server_changed and existing_options:\n                    # In non-tool mode with cache disabled, skip the fast path to force refresh\n                    if not is_in_tool_mode and not use_cache:\n                        pass  # Continue to refresh logic below\n                    else:\n                        if not is_in_tool_mode:\n                            build_config[\"tool\"][\"show\"] = True\n                        return build_config\n\n                # To avoid unnecessary updates, only proceed if the server has actually changed\n                # OR if caching is disabled (to force refresh in non-tool mode)\n                if (_last_selected_server in (current_server_name, \"\")) and build_config[\"tool\"][\"show\"] and use_cache:\n                    if current_server_name:\n                        servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                        if isinstance(servers_cache, dict):\n                            cached = servers_cache.get(current_server_name)\n                            if cached is not None and cached.get(\"tool_names\"):\n                                cached_tools = cached[\"tool_names\"]\n                                current_tools = build_config[\"tool\"][\"options\"]\n                                if current_tools == cached_tools:\n                                    return build_config\n                    else:\n                        return build_config\n                safe_cache_set(self._shared_component_cache, \"last_selected_server\", current_server_name)\n\n                # When cache is disabled, clear any cached data for this server\n                # This ensures we always fetch fresh data from the database\n                if not use_cache and current_server_name:\n                    servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                    if isinstance(servers_cache, dict) and current_server_name in servers_cache:\n                        servers_cache.pop(current_server_name)\n                        safe_cache_set(self._shared_component_cache, \"servers\", servers_cache)\n\n                # Check if tools are already cached for this server before clearing\n                cached_tools = None\n                if current_server_name and use_cache:\n                    servers_cache = safe_cache_get(self._shared_component_cache, \"servers\", {})\n                    if isinstance(servers_cache, dict):\n                        cached = servers_cache.get(current_server_name)\n                        if cached is not None:\n                            try:\n                                cached_tools = cached[\"tools\"]\n                                self.tools = cached_tools\n                                self.tool_names = cached[\"tool_names\"]\n                                self._tool_cache = cached[\"tool_cache\"]\n                            except (TypeError, KeyError, AttributeError) as e:\n                                # Handle corrupted cache data by ignoring it\n                                msg = f\"Unable to use cached data for MCP Server,{current_server_name}: {e}\"\n                                await logger.awarning(msg)\n                                cached_tools = None\n\n                # Clear tools when cache is disabled OR when we don't have cached tools\n                # This ensures fresh tools are fetched after database edits\n                if not cached_tools or not use_cache:\n                    self.tools = []  # Clear previous tools to force refresh\n\n                # Clear previous tool inputs if:\n                # 1. Server actually changed\n                # 2. Cache is disabled (meaning tool list will be refreshed)\n                if server_changed or not use_cache:\n                    self.remove_non_default_keys(build_config)\n\n                # Only show the tool dropdown if not in tool_mode\n                if not is_in_tool_mode:\n                    build_config[\"tool\"][\"show\"] = True\n                    if cached_tools:\n                        # Use cached tools to populate options immediately\n                        build_config[\"tool\"][\"options\"] = [tool.name for tool in cached_tools]\n                        build_config[\"tool\"][\"placeholder\"] = \"Select a tool\"\n                    else:\n                        # Show loading state only when we need to fetch tools\n                        build_config[\"tool\"][\"placeholder\"] = \"Loading tools...\"\n                        build_config[\"tool\"][\"options\"] = []\n                    # Force a value refresh when:\n                    # 1. Server changed\n                    # 2. We don't have cached tools\n                    # 3. Cache is disabled (to force refresh on config changes)\n                    if server_changed or not cached_tools or not use_cache:\n                        build_config[\"tool\"][\"value\"] = uuid.uuid4()\n                else:\n                    # Keep the tool dropdown hidden if in tool_mode\n                    self._not_load_actions = True\n                    build_config[\"tool\"][\"show\"] = False\n\n            elif field_name == \"tool_mode\":\n                build_config[\"tool\"][\"placeholder\"] = \"\"\n                build_config[\"tool\"][\"show\"] = not bool(field_value) and bool(build_config[\"mcp_server\"])\n                self.remove_non_default_keys(build_config)\n                self.tool = build_config[\"tool\"][\"value\"]\n                if field_value:\n                    self._not_load_actions = True\n                else:\n                    build_config[\"tool\"][\"value\"] = uuid.uuid4()\n                    build_config[\"tool\"][\"options\"] = []\n                    build_config[\"tool\"][\"show\"] = True\n                    build_config[\"tool\"][\"placeholder\"] = \"Loading tools...\"\n            elif field_name == \"tools_metadata\":\n                self._not_load_actions = False\n\n        except Exception as e:\n            msg = f\"Error in update_build_config: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n        else:\n            return build_config\n\n    def get_inputs_for_all_tools(self, tools: list) -> dict:\n        \"\"\"Get input schemas for all tools.\"\"\"\n        inputs = {}\n        for tool in tools:\n            if not tool or not hasattr(tool, \"name\"):\n                continue\n            try:\n                flat_schema = flatten_schema(tool.args_schema.schema())\n                input_schema = create_input_schema_from_json_schema(flat_schema)\n                langflow_inputs = schema_to_langflow_inputs(input_schema)\n                inputs[tool.name] = langflow_inputs\n            except (AttributeError, ValueError, TypeError, KeyError) as e:\n                msg = f\"Error getting inputs for tool {getattr(tool, 'name', 'unknown')}: {e!s}\"\n                logger.exception(msg)\n                continue\n        return inputs\n\n    def remove_non_default_keys(self, build_config: dict) -> None:\n        \"\"\"Remove non-default keys from the build config.\"\"\"\n        for key in list(build_config.keys()):\n            if key not in self.default_keys:\n                build_config.pop(key)\n\n    async def _update_tool_config(self, build_config: dict, tool_name: str) -> None:\n        \"\"\"Update tool configuration with proper error handling.\"\"\"\n        if not self.tools:\n            self.tools, build_config[\"mcp_server\"][\"value\"] = await self.update_tool_list()\n\n        if not tool_name:\n            return\n\n        tool_obj = next((tool for tool in self.tools if tool.name == tool_name), None)\n        if not tool_obj:\n            msg = f\"Tool {tool_name} not found in available tools: {self.tools}\"\n            self.remove_non_default_keys(build_config)\n            build_config[\"tool\"][\"value\"] = \"\"\n            await logger.awarning(msg)\n            return\n\n        try:\n            # Store current values before removing inputs (only for the current tool)\n            current_values = {}\n            for key, value in build_config.items():\n                if key not in self.default_keys and isinstance(value, dict) and \"value\" in value:\n                    current_values[key] = value[\"value\"]\n\n            # Remove ALL non-default keys (all previous tool inputs)\n            self.remove_non_default_keys(build_config)\n\n            # Get and validate new inputs for the selected tool\n            self.schema_inputs = await self._validate_schema_inputs(tool_obj)\n            if not self.schema_inputs:\n                msg = f\"No input parameters to configure for tool '{tool_name}'\"\n                await logger.ainfo(msg)\n                return\n\n            # Add new inputs to build config for the selected tool only\n            for schema_input in self.schema_inputs:\n                if not schema_input or not hasattr(schema_input, \"name\"):\n                    msg = \"Invalid schema input detected, skipping\"\n                    await logger.awarning(msg)\n                    continue\n\n                try:\n                    name = schema_input.name\n                    input_dict = schema_input.to_dict()\n                    input_dict.setdefault(\"value\", None)\n                    input_dict.setdefault(\"required\", True)\n\n                    build_config[name] = input_dict\n\n                    # Preserve existing value if the parameter name exists in current_values\n                    if name in current_values:\n                        build_config[name][\"value\"] = current_values[name]\n\n                except (AttributeError, KeyError, TypeError) as e:\n                    msg = f\"Error processing schema input {schema_input}: {e!s}\"\n                    await logger.aexception(msg)\n                    continue\n        except ValueError as e:\n            msg = f\"Schema validation error for tool {tool_name}: {e!s}\"\n            await logger.aexception(msg)\n            self.schema_inputs = []\n            return\n        except (AttributeError, KeyError, TypeError) as e:\n            msg = f\"Error updating tool config: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n\n    async def build_output(self) -> DataFrame:\n        \"\"\"Build output with improved error handling and validation.\"\"\"\n        try:\n            self.tools, _ = await self.update_tool_list()\n            if self.tool != \"\":\n                # Set session context for persistent MCP sessions using Langflow session ID\n                session_context = self._get_session_context()\n                if session_context:\n                    self.stdio_client.set_session_context(session_context)\n                    self.streamable_http_client.set_session_context(session_context)\n                exec_tool = self._tool_cache[self.tool]\n                tool_args = self.get_inputs_for_all_tools(self.tools)[self.tool]\n                kwargs = {}\n                for arg in tool_args:\n                    value = getattr(self, arg.name, None)\n                    if value is not None:\n                        if isinstance(value, Message):\n                            kwargs[arg.name] = value.text\n                        else:\n                            kwargs[arg.name] = value\n\n                unflattened_kwargs = maybe_unflatten_dict(kwargs)\n\n                output = await exec_tool.coroutine(**unflattened_kwargs)\n                tool_content = []\n                for item in output.content:\n                    item_dict = item.model_dump()\n                    item_dict = self.process_output_item(item_dict)\n                    tool_content.append(item_dict)\n\n                if isinstance(tool_content, list) and all(isinstance(x, dict) for x in tool_content):\n                    return DataFrame(tool_content)\n                return DataFrame(data=tool_content)\n            return DataFrame(data=[{\"error\": \"You must select a tool\"}])\n        except Exception as e:\n            msg = f\"Error in build_output: {e!s}\"\n            await logger.aexception(msg)\n            raise ValueError(msg) from e\n\n    def process_output_item(self, item_dict):\n        \"\"\"Process the output of a tool.\"\"\"\n        if item_dict.get(\"type\") == \"text\":\n            text = item_dict.get(\"text\")\n            try:\n                parsed = json.loads(text)\n                # Ensure we always return a dictionary for DataFrame compatibility\n                if isinstance(parsed, dict):\n                    return parsed\n                # Wrap non-dict parsed values in a dictionary\n                return {\"text\": text, \"parsed_value\": parsed, \"type\": \"text\"}  # noqa: TRY300\n            except json.JSONDecodeError:\n                return item_dict\n        return item_dict\n\n    def _get_session_context(self) -> str | None:\n        \"\"\"Get the Langflow session ID for MCP session caching.\"\"\"\n        # Try to get session ID from the component's execution context\n        if hasattr(self, \"graph\") and hasattr(self.graph, \"session_id\"):\n            session_id = self.graph.session_id\n            # Include server name to ensure different servers get different sessions\n            server_name = \"\"\n            mcp_server = getattr(self, \"mcp_server\", None)\n            if isinstance(mcp_server, dict):\n                server_name = mcp_server.get(\"name\", \"\")\n            elif mcp_server:\n                server_name = str(mcp_server)\n            return f\"{session_id}_{server_name}\" if session_id else None\n        return None\n\n    async def _get_tools(self):\n        \"\"\"Get cached tools or update if necessary.\"\"\"\n        mcp_server = getattr(self, \"mcp_server\", None)\n        if not self._not_load_actions:\n            tools, _ = await self.update_tool_list(mcp_server)\n            return tools\n        return []\n"
              },
              "is_refresh": false,
              "mcp_server": {
                "_input_type": "McpInput",
                "advanced": false,
                "display_name": "MCP Server",
                "dynamic": false,
                "info": "Select the MCP Server that will be used by this component",
                "load_from_db": false,
                "name": "mcp_server",
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "mcp",
                "value": {
                  "config": {
                    "url": "http://localhost:8112/sse",
                    "verify_ssl": true
                  },
                  "name": "file_system"
                }
              },
              "tool": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Tool",
                "dynamic": false,
                "external_options": {},
                "info": "Select the tool to execute",
                "name": "tool",
                "options": [],
                "options_metadata": [],
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": true,
                "show": false,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": ""
              },
              "tool_placeholder": {
                "_input_type": "MessageTextInput",
                "advanced": false,
                "display_name": "Tool Placeholder",
                "dynamic": false,
                "info": "Placeholder for the tool",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "tool_placeholder",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "tools_metadata": {
                "_input_type": "ToolsInput",
                "advanced": false,
                "display_name": "Actions",
                "dynamic": false,
                "info": "Modify tool names and descriptions to help agents understand when to use each tool.",
                "is_list": true,
                "list_add_label": "Add More",
                "name": "tools_metadata",
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "tools",
                "value": [
                  {
                    "args": {
                      "head": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Head"
                      },
                      "path": {
                        "title": "Path",
                        "type": "string"
                      },
                      "tail": {
                        "anyOf": [
                          {
                            "type": "integer"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Tail"
                      }
                    },
                    "description": "\n    Read the complete contents of a file from the file system as text.\n    Handles various text encodings and provides detailed error messages if the file cannot be read.\n    Use the 'head' parameter to read only the first N lines of a file, or the 'tail' parameter\n    to read only the last N lines of a file. Only works within allowed directories.\n\n    Args:\n        path: Path to the file to read\n        tail: If provided, returns only the last N lines of the file\n        head: If provided, returns only the first N lines of the file\n    ",
                    "display_description": "\n    Read the complete contents of a file from the file system as text.\n    Handles various text encodings and provides detailed error messages if the file cannot be read.\n    Use the 'head' parameter to read only the first N lines of a file, or the 'tail' parameter\n    to read only the last N lines of a file. Only works within allowed directories.\n\n    Args:\n        path: Path to the file to read\n        tail: If provided, returns only the last N lines of the file\n        head: If provided, returns only the first N lines of the file\n    ",
                    "display_name": "read_text_file",
                    "name": "read_text_file",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "read_text_file"
                    ]
                  },
                  {
                    "args": {
                      "path": {
                        "title": "Path",
                        "type": "string"
                      }
                    },
                    "description": "\n    Read an image or audio file. Returns the base64 encoded data and MIME type.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the media file\n    ",
                    "display_description": "\n    Read an image or audio file. Returns the base64 encoded data and MIME type.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the media file\n    ",
                    "display_name": "read_media_file",
                    "name": "read_media_file",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "read_media_file"
                    ]
                  },
                  {
                    "args": {
                      "paths": {
                        "items": {
                          "type": "string"
                        },
                        "title": "Paths",
                        "type": "array"
                      }
                    },
                    "description": "\n    Read the contents of multiple files simultaneously. This is more efficient than reading\n    files one by one when you need to analyze or compare multiple files. Each file's content\n    is returned with its path as a reference. Failed reads for individual files won't stop\n    the entire operation. Only works within allowed directories.\n\n    Args:\n        paths: Array of file paths to read\n    ",
                    "display_description": "\n    Read the contents of multiple files simultaneously. This is more efficient than reading\n    files one by one when you need to analyze or compare multiple files. Each file's content\n    is returned with its path as a reference. Failed reads for individual files won't stop\n    the entire operation. Only works within allowed directories.\n\n    Args:\n        paths: Array of file paths to read\n    ",
                    "display_name": "read_multiple_files",
                    "name": "read_multiple_files",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "read_multiple_files"
                    ]
                  },
                  {
                    "args": {
                      "content": {
                        "title": "Content",
                        "type": "string"
                      },
                      "path": {
                        "title": "Path",
                        "type": "string"
                      }
                    },
                    "description": "\n    Create a new file or completely overwrite an existing file with new content.\n    Use with caution as it will overwrite existing files without warning.\n    Handles text content with proper encoding. Only works within allowed directories.\n\n    Args:\n        path: Path to the file to write\n        content: Content to write to the file\n    ",
                    "display_description": "\n    Create a new file or completely overwrite an existing file with new content.\n    Use with caution as it will overwrite existing files without warning.\n    Handles text content with proper encoding. Only works within allowed directories.\n\n    Args:\n        path: Path to the file to write\n        content: Content to write to the file\n    ",
                    "display_name": "write_file",
                    "name": "write_file",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "write_file"
                    ]
                  },
                  {
                    "args": {
                      "dryRun": {
                        "anyOf": [
                          {
                            "type": "boolean"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": false,
                        "title": "Dryrun"
                      },
                      "edits": {
                        "items": {
                          "$ref": "#/$defs/AnonModel0"
                        },
                        "title": "Edits",
                        "type": "array"
                      },
                      "path": {
                        "title": "Path",
                        "type": "string"
                      }
                    },
                    "description": "\n    Make line-based edits to a text file. Each edit replaces exact line sequences\n    with new content. Returns a git-style diff showing the changes made.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the file to edit\n        edits: List of edit operations, each with 'oldText' and 'newText'\n        dryRun: Preview changes using git-style diff format without applying them\n    ",
                    "display_description": "\n    Make line-based edits to a text file. Each edit replaces exact line sequences\n    with new content. Returns a git-style diff showing the changes made.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the file to edit\n        edits: List of edit operations, each with 'oldText' and 'newText'\n        dryRun: Preview changes using git-style diff format without applying them\n    ",
                    "display_name": "edit_file",
                    "name": "edit_file",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "edit_file"
                    ]
                  },
                  {
                    "args": {
                      "path": {
                        "title": "Path",
                        "type": "string"
                      }
                    },
                    "description": "\n    Create a new directory or ensure a directory exists. Can create multiple nested\n    directories in one operation. If the directory already exists, this operation\n    will succeed silently. Perfect for setting up directory structures for projects\n    or ensuring required paths exist. Only works within allowed directories.\n\n    Args:\n        path: Path to the directory to create\n    ",
                    "display_description": "\n    Create a new directory or ensure a directory exists. Can create multiple nested\n    directories in one operation. If the directory already exists, this operation\n    will succeed silently. Perfect for setting up directory structures for projects\n    or ensuring required paths exist. Only works within allowed directories.\n\n    Args:\n        path: Path to the directory to create\n    ",
                    "display_name": "create_directory",
                    "name": "create_directory",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "create_directory"
                    ]
                  },
                  {
                    "args": {
                      "path": {
                        "title": "Path",
                        "type": "string"
                      }
                    },
                    "description": "\n    Get a detailed listing of all files and directories in a specified path.\n    Results clearly distinguish between files and directories with [FILE] and [DIR]\n    prefixes. This tool is essential for understanding directory structure and\n    finding specific files within a directory. Only works within allowed directories.\n\n    Args:\n        path: Path to the directory to list\n    ",
                    "display_description": "\n    Get a detailed listing of all files and directories in a specified path.\n    Results clearly distinguish between files and directories with [FILE] and [DIR]\n    prefixes. This tool is essential for understanding directory structure and\n    finding specific files within a directory. Only works within allowed directories.\n\n    Args:\n        path: Path to the directory to list\n    ",
                    "display_name": "list_directory",
                    "name": "list_directory",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "list_directory"
                    ]
                  },
                  {
                    "args": {
                      "path": {
                        "title": "Path",
                        "type": "string"
                      },
                      "sortBy": {
                        "anyOf": [
                          {
                            "type": "string"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": "name",
                        "title": "Sortby"
                      }
                    },
                    "description": "\n    Get a detailed listing of all files and directories in a specified path, including sizes.\n    Results clearly distinguish between files and directories with [FILE] and [DIR] prefixes.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the directory to list\n        sortBy: Sort entries by 'name' or 'size' (default: 'name')\n    ",
                    "display_description": "\n    Get a detailed listing of all files and directories in a specified path, including sizes.\n    Results clearly distinguish between files and directories with [FILE] and [DIR] prefixes.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the directory to list\n        sortBy: Sort entries by 'name' or 'size' (default: 'name')\n    ",
                    "display_name": "list_directory_with_sizes",
                    "name": "list_directory_with_sizes",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "list_directory_with_sizes"
                    ]
                  },
                  {
                    "args": {
                      "excludePatterns": {
                        "anyOf": [
                          {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Excludepatterns"
                      },
                      "path": {
                        "title": "Path",
                        "type": "string"
                      }
                    },
                    "description": "\n    Get a recursive tree view of files and directories as a JSON structure.\n    Each entry includes 'name', 'type' (file/directory), and 'children' for directories.\n    Files have no children array, while directories always have a children array\n    (which may be empty). The output is formatted with 2-space indentation for readability.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the root directory\n        excludePatterns: List of patterns to exclude\n    ",
                    "display_description": "\n    Get a recursive tree view of files and directories as a JSON structure.\n    Each entry includes 'name', 'type' (file/directory), and 'children' for directories.\n    Files have no children array, while directories always have a children array\n    (which may be empty). The output is formatted with 2-space indentation for readability.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the root directory\n        excludePatterns: List of patterns to exclude\n    ",
                    "display_name": "directory_tree",
                    "name": "directory_tree",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "directory_tree"
                    ]
                  },
                  {
                    "args": {
                      "destination": {
                        "title": "Destination",
                        "type": "string"
                      },
                      "source": {
                        "title": "Source",
                        "type": "string"
                      }
                    },
                    "description": "\n    Move or rename files and directories. Can move files between directories and rename\n    them in a single operation. If the destination exists, the operation will fail.\n    Works across different directories and can be used for simple renaming within the\n    same directory. Both source and destination must be within allowed directories.\n\n    Args:\n        source: Source path\n        destination: Destination path\n    ",
                    "display_description": "\n    Move or rename files and directories. Can move files between directories and rename\n    them in a single operation. If the destination exists, the operation will fail.\n    Works across different directories and can be used for simple renaming within the\n    same directory. Both source and destination must be within allowed directories.\n\n    Args:\n        source: Source path\n        destination: Destination path\n    ",
                    "display_name": "move_file",
                    "name": "move_file",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "move_file"
                    ]
                  },
                  {
                    "args": {
                      "excludePatterns": {
                        "anyOf": [
                          {
                            "items": {
                              "type": "string"
                            },
                            "type": "array"
                          },
                          {
                            "type": "null"
                          }
                        ],
                        "default": null,
                        "title": "Excludepatterns"
                      },
                      "path": {
                        "title": "Path",
                        "type": "string"
                      },
                      "pattern": {
                        "title": "Pattern",
                        "type": "string"
                      }
                    },
                    "description": "\n    Recursively search for files and directories matching a pattern.\n    The patterns should be glob-style patterns that match paths relative to the working directory.\n    Use pattern like '*.ext' to match files in current directory, and '**/*.ext' to match\n    files in all subdirectories. Returns full paths to all matching items.\n    Only searches within allowed directories.\n\n    Args:\n        path: Root path to search from\n        pattern: Glob pattern to match\n        excludePatterns: List of patterns to exclude\n    ",
                    "display_description": "\n    Recursively search for files and directories matching a pattern.\n    The patterns should be glob-style patterns that match paths relative to the working directory.\n    Use pattern like '*.ext' to match files in current directory, and '**/*.ext' to match\n    files in all subdirectories. Returns full paths to all matching items.\n    Only searches within allowed directories.\n\n    Args:\n        path: Root path to search from\n        pattern: Glob pattern to match\n        excludePatterns: List of patterns to exclude\n    ",
                    "display_name": "search_files",
                    "name": "search_files",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "search_files"
                    ]
                  },
                  {
                    "args": {
                      "path": {
                        "title": "Path",
                        "type": "string"
                      }
                    },
                    "description": "\n    Retrieve detailed metadata about a file or directory. Returns comprehensive information\n    including size, creation time, last modified time, permissions, and type. This tool is\n    perfect for understanding file characteristics without reading the actual content.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the file or directory\n    ",
                    "display_description": "\n    Retrieve detailed metadata about a file or directory. Returns comprehensive information\n    including size, creation time, last modified time, permissions, and type. This tool is\n    perfect for understanding file characteristics without reading the actual content.\n    Only works within allowed directories.\n\n    Args:\n        path: Path to the file or directory\n    ",
                    "display_name": "get_file_info",
                    "name": "get_file_info",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "get_file_info"
                    ]
                  },
                  {
                    "args": {},
                    "description": "\n    Returns the list of directories that this server is allowed to access.\n    Subdirectories within these allowed directories are also accessible.\n    Use this to understand which directories and their nested paths are available\n    before trying to access files.\n    ",
                    "display_description": "\n    Returns the list of directories that this server is allowed to access.\n    Subdirectories within these allowed directories are also accessible.\n    Use this to understand which directories and their nested paths are available\n    before trying to access files.\n    ",
                    "display_name": "list_allowed_directories",
                    "name": "list_allowed_directories",
                    "readonly": false,
                    "status": true,
                    "tags": [
                      "list_allowed_directories"
                    ]
                  }
                ]
              },
              "use_cache": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Use Cached Server",
                "dynamic": false,
                "info": "Enable caching of MCP Server and tools to improve performance. Disable to always fetch fresh tools and server updates.",
                "list": false,
                "list_add_label": "Add More",
                "name": "use_cache",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": false
              },
              "verify_ssl": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Verify SSL Certificate",
                "dynamic": false,
                "info": "Enable SSL certificate verification for HTTPS connections. Disable only for development/testing with self-signed certificates.",
                "list": false,
                "list_add_label": "Add More",
                "name": "verify_ssl",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              }
            },
            "tool_mode": true
          },
          "showNode": true,
          "type": "MCPTools"
        },
        "dragging": false,
        "id": "MCPTools-6jiqJ",
        "measured": {
          "height": 311,
          "width": 320
        },
        "position": {
          "x": 1060.3921915115432,
          "y": 68.00162675057558
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "ComposioGmailAPIComponent-Rc6PI",
          "node": {
            "base_classes": [
              "DataFrame"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "display_name": "Gmail",
            "documentation": "https://docs.composio.dev",
            "edited": false,
            "field_order": [
              "entity_id",
              "api_key",
              "auth_mode",
              "auth_link",
              "client_id",
              "client_secret",
              "verification_token",
              "redirect_uri",
              "authorization_url",
              "token_url",
              "api_key_field",
              "generic_api_key",
              "token",
              "access_token",
              "refresh_token",
              "username",
              "password",
              "domain",
              "base_url",
              "bearer_token",
              "authorization_code",
              "scopes",
              "subdomain",
              "instance_url",
              "tenant_id",
              "action_button"
            ],
            "frozen": false,
            "icon": "Gmail",
            "last_updated": "2025-12-18T10:50:05.654Z",
            "legacy": false,
            "lf_version": "1.7.0",
            "metadata": {
              "code_hash": "d4b13ac8a3a1",
              "dependencies": {
                "dependencies": [
                  {
                    "name": "lfx",
                    "version": null
                  }
                ],
                "total_dependencies": 1
              },
              "module": "lfx.components.composio.gmail_composio.ComposioGmailAPIComponent"
            },
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Toolset",
                "group_outputs": false,
                "hidden": null,
                "loop_types": null,
                "method": "to_toolkit",
                "name": "component_as_tool",
                "options": null,
                "required_inputs": null,
                "selected": "Tool",
                "tool_mode": true,
                "types": [
                  "Tool"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_frontend_node_flow_id": {
                "input_types": [],
                "value": "af63ae2e-2804-4ab5-9259-4e337a09a401"
              },
              "_frontend_node_folder_id": {
                "input_types": [],
                "value": "9d4e6e89-4355-4367-8927-de9e2800dfeb"
              },
              "_type": "Component",
              "access_token": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Access Token",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "access_token",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "action_button": {
                "_input_type": "SortableListInput",
                "advanced": false,
                "display_name": "Action",
                "dynamic": false,
                "helper_text": "",
                "helper_text_metadata": {},
                "info": "",
                "input_types": [],
                "limit": 1,
                "name": "action_button",
                "options": [
                  {
                    "metadata": "GMAIL_ADD_LABEL_TO_EMAIL",
                    "name": "Modify email labels"
                  },
                  {
                    "metadata": "GMAIL_BATCH_DELETE_MESSAGES",
                    "name": "Batch delete Gmail messages"
                  },
                  {
                    "metadata": "GMAIL_BATCH_MODIFY_MESSAGES",
                    "name": "Batch modify Gmail messages"
                  },
                  {
                    "metadata": "GMAIL_CREATE_EMAIL_DRAFT",
                    "name": "Create email draft"
                  },
                  {
                    "metadata": "GMAIL_CREATE_LABEL",
                    "name": "Create label"
                  },
                  {
                    "metadata": "GMAIL_DELETE_DRAFT",
                    "name": "Delete Draft"
                  },
                  {
                    "metadata": "GMAIL_DELETE_MESSAGE",
                    "name": "Delete message"
                  },
                  {
                    "metadata": "GMAIL_FETCH_EMAILS",
                    "name": "Fetch emails"
                  },
                  {
                    "metadata": "GMAIL_FETCH_MESSAGE_BY_MESSAGE_ID",
                    "name": "Fetch message by message ID"
                  },
                  {
                    "metadata": "GMAIL_FETCH_MESSAGE_BY_THREAD_ID",
                    "name": "Fetch Message by Thread ID"
                  },
                  {
                    "metadata": "GMAIL_FORWARD_MESSAGE",
                    "name": "Forward email message"
                  },
                  {
                    "metadata": "GMAIL_GET_ATTACHMENT",
                    "name": "Get Gmail attachment"
                  },
                  {
                    "metadata": "GMAIL_GET_CONTACTS",
                    "name": "Get contacts"
                  },
                  {
                    "metadata": "GMAIL_GET_PEOPLE",
                    "name": "Get People"
                  },
                  {
                    "metadata": "GMAIL_GET_PROFILE",
                    "name": "Get Profile"
                  },
                  {
                    "metadata": "GMAIL_LIST_DRAFTS",
                    "name": "List drafts"
                  },
                  {
                    "metadata": "GMAIL_LIST_HISTORY",
                    "name": "List Gmail history"
                  },
                  {
                    "metadata": "GMAIL_LIST_LABELS",
                    "name": "List Gmail labels"
                  },
                  {
                    "metadata": "GMAIL_LIST_THREADS",
                    "name": "List threads"
                  },
                  {
                    "metadata": "GMAIL_MODIFY_THREAD_LABELS",
                    "name": "Modify thread labels"
                  },
                  {
                    "metadata": "GMAIL_MOVE_TO_TRASH",
                    "name": "Move to Trash"
                  },
                  {
                    "metadata": "GMAIL_PATCH_LABEL",
                    "name": "Patch Label"
                  },
                  {
                    "metadata": "GMAIL_REMOVE_LABEL",
                    "name": "Remove label"
                  },
                  {
                    "metadata": "GMAIL_REPLY_TO_THREAD",
                    "name": "Reply to email thread"
                  },
                  {
                    "metadata": "GMAIL_SEARCH_PEOPLE",
                    "name": "Search People"
                  },
                  {
                    "metadata": "GMAIL_SEND_DRAFT",
                    "name": "Send Draft"
                  },
                  {
                    "metadata": "GMAIL_SEND_EMAIL",
                    "name": "Send Email"
                  }
                ],
                "placeholder": "Select action",
                "real_time_refresh": true,
                "required": false,
                "search_category": [],
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "sortableList",
                "value": "disabled"
              },
              "api_key": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Composio API Key",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "api_key",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": true,
                "show": true,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "api_key_field": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "API Key",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "api_key_field",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "auth_link": {
                "_input_type": "AuthInput",
                "advanced": false,
                "auth_scheme": "OAUTH2",
                "auth_tooltip": "Disconnect",
                "connection_id": "ca_QDUb7GXDNDGi",
                "display_name": "",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "name": "auth_link",
                "placeholder": "",
                "required": false,
                "show": false,
                "title_case": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "auth",
                "value": "validated"
              },
              "auth_mode": {
                "_input_type": "TabInput",
                "advanced": false,
                "display_name": "Auth Mode",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "name": "auth_mode",
                "options": [
                  "OAUTH2"
                ],
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "tab",
                "value": "OAUTH2"
              },
              "authorization_code": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Authorization Code",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "authorization_code",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "authorization_url": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Authorization URL",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "authorization_url",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "base_url": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Base URL",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "base_url",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "bearer_token": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Bearer Token",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "bearer_token",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "client_id": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Client id",
                "dynamic": false,
                "info": "Client id of the app",
                "input_types": [],
                "load_from_db": false,
                "name": "client_id",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "client_secret": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Client secret",
                "dynamic": false,
                "info": "Client secret of the app",
                "input_types": [],
                "load_from_db": false,
                "name": "client_secret",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "input_types": [],
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": false,
                "title_case": false,
                "type": "code",
                "value": "from lfx.base.composio.composio_base import ComposioBaseComponent\n\n\nclass ComposioGmailAPIComponent(ComposioBaseComponent):\n    display_name: str = \"Gmail\"\n    icon = \"Gmail\"\n    documentation: str = \"https://docs.composio.dev\"\n    app_name = \"gmail\"\n\n    def __init__(self, **kwargs):\n        super().__init__(**kwargs)\n        self.post_processors = {\n            \"GMAIL_SEND_EMAIL\": self._process_send_email_response,\n            \"GMAIL_FETCH_EMAILS\": self._process_fetch_emails_response,\n        }\n\n    def _process_send_email_response(self, raw_data):\n        \"\"\"Post-processor for GMAIL_SEND_EMAIL action.\"\"\"\n        if isinstance(raw_data, dict):\n            response_data = raw_data.get(\"response_data\", raw_data)\n\n            return {\n                \"message_id\": response_data.get(\"id\"),\n                \"thread_id\": response_data.get(\"threadId\"),\n                \"label_ids\": response_data.get(\"labelIds\", []),\n            }\n        return raw_data\n\n    def _process_fetch_emails_response(self, raw_data):\n        \"\"\"Post-processor for GMAIL_FETCH_EMAILS action.\"\"\"\n        if isinstance(raw_data, dict):\n            messages = raw_data.get(\"messages\", [])\n            if messages:\n                return messages\n        return raw_data\n\n    def set_default_tools(self):\n        \"\"\"Set the default tools for Gmail component.\"\"\"\n"
              },
              "create_auth_config": {
                "input_types": [],
                "show": false
              },
              "domain": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Domain",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "domain",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "entity_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Entity ID",
                "dynamic": false,
                "info": "",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "entity_id",
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": "default"
              },
              "generic_api_key": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "API Key",
                "dynamic": false,
                "info": "Enter API key on Composio page",
                "input_types": [],
                "load_from_db": false,
                "name": "generic_api_key",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "instance_url": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Instance URL",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "instance_url",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "is_refresh": false,
              "password": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Password",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "password",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "redirect_uri": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Redirect URI",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "redirect_uri",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "refresh_token": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Refresh Token",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "refresh_token",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "scopes": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Scopes",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "scopes",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "subdomain": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Subdomain",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "subdomain",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "tenant_id": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Tenant ID",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "tenant_id",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "token": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Token",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "load_from_db": false,
                "name": "token",
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "token_url": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Token URL",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "token_url",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "tool_mode": {
                "input_types": [],
                "value": true
              },
              "tools_metadata": {
                "_input_type": "ToolsInput",
                "advanced": false,
                "display_name": "Actions",
                "dynamic": false,
                "info": "Modify tool names and descriptions to help agents understand when to use each tool.",
                "is_list": true,
                "list_add_label": "Add More",
                "name": "tools_metadata",
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "tools",
                "value": [
                  {
                    "_uniqueId": "gmail_add_label_to_email_Modify email labels_0",
                    "args": {
                      "add_label_ids": {
                        "default": [],
                        "description": "Label IDs to add. For custom labels, obtain IDs via 'listLabels'. System labels (e.g., 'INBOX', 'SPAM', 'STARRED', 'IMPORTANT') can be used, but immutable system labels like 'DRAFT' and 'SENT' cannot be added or removed. At least one of 'add_label_ids' or 'remove_label_ids' must be non-empty.",
                        "examples": [
                          "STARRED",
                          "IMPORTANT",
                          "Label_123"
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Add Label Ids",
                        "type": "array"
                      },
                      "message_id": {
                        "description": "Immutable ID of the message to modify (e.g., from 'fetchEmails' or 'fetchMessagesByThreadId'). Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "17f1b2b9c1b2a3d4"
                        ],
                        "title": "Message Id",
                        "type": "string"
                      },
                      "remove_label_ids": {
                        "default": [],
                        "description": "Label IDs to remove. For custom labels, obtain IDs via 'listLabels'. System labels can be used, but immutable system labels like 'DRAFT' and 'SENT' cannot be added or removed via messages.modify. At least one of 'add_label_ids' or 'remove_label_ids' must be non-empty.",
                        "examples": [
                          "UNREAD",
                          "Label_456"
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Remove Label Ids",
                        "type": "array"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Adds and/or removes specified Gmail labels for a message; ensure `message_id` and all `label_ids` are valid (use 'listLabels' for custom label IDs).",
                    "display_description": "Adds and/or removes specified Gmail labels for a message; ensure `message_id` and all `label_ids` are valid (use 'listLabels' for custom label IDs).",
                    "display_name": "Modify email labels",
                    "name": "gmail_add_label_to_email",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_ADD_LABEL_TO_EMAIL"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_batch_delete_messages_Batch delete Gmail messages_1",
                    "args": {
                      "ids": {
                        "description": "List of message IDs to delete. Obtain IDs via list or fetch actions. This parameter is required.",
                        "examples": [
                          [
                            "18c5f5d1a2b3c4d5",
                            "18c5f5d1a2b3c4d6"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Ids",
                        "type": "array"
                      },
                      "userId": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "Userid",
                        "type": "string"
                      }
                    },
                    "description": "Tool to permanently delete multiple Gmail messages in bulk. Use when you need to efficiently remove large numbers of emails (e.g., retention enforcement, mailbox hygiene).",
                    "display_description": "Tool to permanently delete multiple Gmail messages in bulk. Use when you need to efficiently remove large numbers of emails (e.g., retention enforcement, mailbox hygiene).",
                    "display_name": "Batch delete Gmail messages",
                    "name": "gmail_batch_delete_messages",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_BATCH_DELETE_MESSAGES"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_batch_modify_messages_Batch modify Gmail messages_2",
                    "args": {
                      "addLabelIds": {
                        "default": null,
                        "description": "List of label IDs to add to the messages. Common label IDs: INBOX, STARRED, IMPORTANT, SENT, DRAFT, SPAM, TRASH, UNREAD. Use GMAIL_LIST_LABELS to get custom label IDs. Leave empty to skip adding labels.",
                        "examples": [
                          [
                            "INBOX",
                            "STARRED"
                          ],
                          [
                            "Label_123",
                            "Label_456"
                          ],
                          [
                            "IMPORTANT"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Addlabelids",
                        "type": "array"
                      },
                      "messageIds": {
                        "description": "List of message IDs to modify. Maximum 1,000 message IDs per request. Get message IDs from GMAIL_FETCH_EMAILS or GMAIL_LIST_THREADS actions. This parameter is required.",
                        "examples": [
                          [
                            "18c5f5d1a2b3c4d5",
                            "18c5f5d1a2b3c4d6"
                          ],
                          [
                            "msg_id_1",
                            "msg_id_2",
                            "msg_id_3"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Messageids",
                        "type": "array"
                      },
                      "removeLabelIds": {
                        "default": null,
                        "description": "List of label IDs to remove from the messages. Common use cases: Remove 'UNREAD' to mark as read, remove 'INBOX' to archive, remove 'SPAM' to unmark spam. Leave empty to skip removing labels.",
                        "examples": [
                          [
                            "UNREAD"
                          ],
                          [
                            "INBOX",
                            "UNREAD"
                          ],
                          [
                            "SPAM"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Removelabelids",
                        "type": "array"
                      },
                      "userId": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "Userid",
                        "type": "string"
                      }
                    },
                    "description": "Modify labels on multiple Gmail messages in one efficient API call. Supports up to 1,000 messages per request for bulk operations like archiving, marking as read/unread, or applying custom labels.",
                    "display_description": "Modify labels on multiple Gmail messages in one efficient API call. Supports up to 1,000 messages per request for bulk operations like archiving, marking as read/unread, or applying custom labels.",
                    "display_name": "Batch modify Gmail messages",
                    "name": "gmail_batch_modify_messages",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_BATCH_MODIFY_MESSAGES"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_create_email_draft_Create email draft_3",
                    "args": {
                      "attachment": {
                        "default": null,
                        "description": "File to attach to the email.",
                        "examples": [],
                        "title": "Attachment",
                        "type": "string"
                      },
                      "bcc": {
                        "default": [],
                        "description": "Blind Carbon Copy (BCC) recipients' email addresses. Atleast one of cc, bcc, or recipient_email must be provided.",
                        "examples": [
                          [
                            "bcc.recipient@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Bcc",
                        "type": "array"
                      },
                      "body": {
                        "default": null,
                        "description": "Email body content (plain text or HTML); `is_html` must be True if HTML. Either subject or body must be provided. Please provide a value of type string.",
                        "examples": [
                          "Hello Team,\n\nPlease find the attached report for your review.\n\nBest regards,\nYour Name",
                          "<h1>Meeting Confirmation</h1><p>This email confirms our meeting scheduled for next Tuesday.</p>"
                        ],
                        "title": "Body",
                        "type": "string"
                      },
                      "cc": {
                        "default": [],
                        "description": "Carbon Copy (CC) recipients' email addresses. Atleast one of cc, bcc, or recipient_email must be provided.",
                        "examples": [
                          [
                            "cc.recipient1@example.com",
                            "cc.recipient2@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Cc",
                        "type": "array"
                      },
                      "extra_recipients": {
                        "default": [],
                        "description": "Additional 'To' recipients' email addresses (not Cc or Bcc). Should only be used if recipient_email is also provided.",
                        "examples": [
                          [
                            "jane.doe@example.com",
                            "another.recipient@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Extra Recipients",
                        "type": "array"
                      },
                      "is_html": {
                        "default": false,
                        "description": "Set to True if `body` is HTML, otherwise the action may fail. Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Is Html",
                        "type": "boolean"
                      },
                      "recipient_email": {
                        "default": null,
                        "description": "Primary recipient's email address. Required if cc and bcc is not provided, else can be optional. Use extra_recipients if you want to send to multiple recipients. Please provide a value of type string.",
                        "examples": [
                          "john.doe@example.com"
                        ],
                        "title": "Recipient Email",
                        "type": "string"
                      },
                      "subject": {
                        "default": null,
                        "description": "Email subject line. Either subject or body must be provided. When creating a draft reply to an existing thread (thread_id provided), leave this empty to stay in the same thread. Setting a subject will create a NEW thread instead. Please provide a value of type string.",
                        "examples": [
                          "Project Update Q3",
                          "Meeting Reminder"
                        ],
                        "title": "Subject",
                        "type": "string"
                      },
                      "thread_id": {
                        "default": null,
                        "description": "ID of an existing Gmail thread to reply to; omit for new thread. Please provide a value of type string.",
                        "examples": [
                          "17f45ec49a9c3f1b"
                        ],
                        "title": "Thread Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Creates a Gmail email draft, requiring at least one of recipient_email, cc, or bcc must be provided. Atleast one of subject or body must be provided. Supports To/Cc/Bcc, subject, plain/HTML body (ensure `is_html=True` for HTML), attachments, and threading. When creating a draft reply to an existing thread (thread_id provided), leave subject empty to stay in the same thread; setting a subject will create a NEW thread instead.",
                    "display_description": "Creates a Gmail email draft, requiring at least one of recipient_email, cc, or bcc must be provided. Atleast one of subject or body must be provided. Supports To/Cc/Bcc, subject, plain/HTML body (ensure `is_html=True` for HTML), attachments, and threading. When creating a draft reply to an existing thread (thread_id provided), leave subject empty to stay in the same thread; setting a subject will create a NEW thread instead.",
                    "display_name": "Create email draft",
                    "name": "gmail_create_email_draft",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_CREATE_EMAIL_DRAFT"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_create_label_Create label_4",
                    "args": {
                      "background_color": {
                        "default": null,
                        "description": "Background color for the label. Must be selected from Gmail's predefined color palette of over 100 colors (not arbitrary hex values). If setting a color, both background_color and text_color must be provided. See the official Color field documentation for the full palette: https://developers.google.com/workspace/gmail/api/reference/rest/v1/users.labels#Color. Please provide a value of type string.",
                        "examples": [
                          "#4a86e8",
                          "#43d692"
                        ],
                        "title": "Background Color",
                        "type": "string"
                      },
                      "label_list_visibility": {
                        "default": "labelShow",
                        "description": "Controls how the label is displayed in the label list in the Gmail sidebar. Please provide a value of type string.",
                        "examples": [
                          "labelShow",
                          "labelShowIfUnread",
                          "labelHide"
                        ],
                        "title": "Label List Visibility",
                        "type": "string"
                      },
                      "label_name": {
                        "description": "The name for the new label. Must be unique within the account, non-blank, maximum length 225 characters, cannot contain ',', '/', or '.' (period), not only whitespace, and must not be a reserved system label (e.g., INBOX, SENT, DRAFT, SPAM, TRASH, ALL_MAIL, CATEGORY_*). Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "Work",
                          "Important Documents",
                          "Receipts 2024"
                        ],
                        "title": "Label Name",
                        "type": "string"
                      },
                      "message_list_visibility": {
                        "default": "show",
                        "description": "Controls how messages with this label are displayed in the message list. Please provide a value of type string.",
                        "examples": [
                          "show",
                          "hide"
                        ],
                        "title": "Message List Visibility",
                        "type": "string"
                      },
                      "text_color": {
                        "default": null,
                        "description": "Text color for the label. Must be selected from Gmail's predefined color palette of over 100 colors (not arbitrary hex values). If setting a color, both text_color and background_color must be provided. See the official Color field documentation for the full palette: https://developers.google.com/workspace/gmail/api/reference/rest/v1/users.labels#Color. Please provide a value of type string.",
                        "examples": [
                          "#000000",
                          "#ffffff",
                          "#aa8831"
                        ],
                        "title": "Text Color",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "The email address of the user in whose account the label will be created. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Creates a new label with a unique name in the specified user's Gmail account.",
                    "display_description": "Creates a new label with a unique name in the specified user's Gmail account.",
                    "display_name": "Create label",
                    "name": "gmail_create_label",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_CREATE_LABEL"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_delete_draft_Delete Draft_5",
                    "args": {
                      "draft_id": {
                        "description": "Immutable ID of the draft to delete, typically obtained when the draft was created. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "r-8388446164079304564"
                        ],
                        "title": "Draft Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user; 'me' is recommended. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Permanently deletes a specific Gmail draft using its ID; ensure the draft exists and the user has necessary permissions for the given `user_id`.",
                    "display_description": "Permanently deletes a specific Gmail draft using its ID; ensure the draft exists and the user has necessary permissions for the given `user_id`.",
                    "display_name": "Delete Draft",
                    "name": "gmail_delete_draft",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_DELETE_DRAFT"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_delete_message_Delete message_6",
                    "args": {
                      "message_id": {
                        "description": "Identifier of the email message to delete. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "185120e4428ba8cf",
                          "17a872b77b9e7a3b"
                        ],
                        "title": "Message Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address. The special value 'me' refers to the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Permanently deletes a specific email message by its ID from a Gmail mailbox; for `user_id`, use 'me' for the authenticated user or an email address to which the authenticated user has delegated access.",
                    "display_description": "Permanently deletes a specific email message by its ID from a Gmail mailbox; for `user_id`, use 'me' for the authenticated user or an email address to which the authenticated user has delegated access.",
                    "display_name": "Delete message",
                    "name": "gmail_delete_message",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_DELETE_MESSAGE"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_fetch_emails_Fetch emails_7",
                    "args": {
                      "ids_only": {
                        "default": false,
                        "description": "If true, only returns message IDs from the list API without fetching individual message details. Fastest option for getting just message IDs and thread IDs. Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Ids Only",
                        "type": "boolean"
                      },
                      "include_payload": {
                        "default": true,
                        "description": "Set to true to include full message payload (headers, body, attachments); false for metadata only. Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Include Payload",
                        "type": "boolean"
                      },
                      "include_spam_trash": {
                        "default": false,
                        "description": "Set to true to include messages from 'SPAM' and 'TRASH'. Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Include Spam Trash",
                        "type": "boolean"
                      },
                      "label_ids": {
                        "default": null,
                        "description": "Filter by label IDs; only messages with all specified labels are returned. Common IDs: 'INBOX', 'SPAM', 'TRASH', 'UNREAD', 'STARRED', 'IMPORTANT', 'CATEGORY_PRIMARY' (alias 'CATEGORY_PERSONAL'), 'CATEGORY_SOCIAL', 'CATEGORY_PROMOTIONS', 'CATEGORY_UPDATES', 'CATEGORY_FORUMS'. Use 'listLabels' action for custom IDs.",
                        "examples": [],
                        "items": {
                          "type": "string"
                        },
                        "title": "Label Ids",
                        "type": "array"
                      },
                      "max_results": {
                        "default": 1,
                        "description": "Maximum number of messages to retrieve per page. Please provide a value of type integer.",
                        "examples": [
                          "10",
                          "100",
                          "500"
                        ],
                        "title": "Max Results",
                        "type": "integer"
                      },
                      "page_token": {
                        "default": null,
                        "description": "Token for retrieving a specific page, obtained from a previous response's `nextPageToken`. Omit for the first page. Please provide a value of type string.",
                        "examples": [],
                        "title": "Page Token",
                        "type": "string"
                      },
                      "query": {
                        "default": null,
                        "description": "Gmail advanced search query (e.g., 'from:user subject:meeting'). Supports operators like 'from:', 'to:', 'subject:', 'label:', 'has:attachment', 'is:unread', 'after:YYYY/MM/DD', 'before:YYYY/MM/DD', AND/OR/NOT. Use quotes for exact phrases. Omit for no query filter. Please provide a value of type string.",
                        "examples": [
                          "from:john@example.com is:unread",
                          "subject:meeting has:attachment",
                          "after:2024/01/01 before:2024/02/01",
                          "is:important OR is:starred",
                          "label:work -label:spam"
                        ],
                        "title": "Query",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      },
                      "verbose": {
                        "default": true,
                        "description": "If false, uses optimized concurrent metadata fetching for faster performance (~75% improvement). If true, uses standard detailed message fetching. When false, only essential fields (subject, sender, recipient, time, labels) are guaranteed. Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Verbose",
                        "type": "boolean"
                      }
                    },
                    "description": "Fetches a list of email messages from a Gmail account, supporting filtering, pagination, and optional full content retrieval.",
                    "display_description": "Fetches a list of email messages from a Gmail account, supporting filtering, pagination, and optional full content retrieval.",
                    "display_name": "Fetch emails",
                    "name": "gmail_fetch_emails",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_FETCH_EMAILS"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_fetch_message_by_message_id_Fetch message by message ID_8",
                    "args": {
                      "format": {
                        "default": "full",
                        "description": "Format for message content: 'minimal' (ID/labels), 'full' (complete data), 'raw' (base64url string), 'metadata' (ID/labels/headers). Please provide a value of type string.",
                        "examples": [
                          "minimal",
                          "full",
                          "raw",
                          "metadata"
                        ],
                        "title": "Format",
                        "type": "string"
                      },
                      "message_id": {
                        "description": "Unique ID of the email message to retrieve, obtainable from actions like 'List Messages'. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "xsdfe3264vrfw"
                        ],
                        "title": "Message Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "user@example.com",
                          "me"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Fetches a specific email message by its ID, provided the `message_id` exists and is accessible to the authenticated `user_id`.",
                    "display_description": "Fetches a specific email message by its ID, provided the `message_id` exists and is accessible to the authenticated `user_id`.",
                    "display_name": "Fetch message by message ID",
                    "name": "gmail_fetch_message_by_message_id",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_FETCH_MESSAGE_BY_MESSAGE_ID"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_fetch_message_by_thread_id_Fetch Message by Thread ID_9",
                    "args": {
                      "page_token": {
                        "default": "",
                        "description": "Opaque page token for fetching a specific page of messages if results are paginated. Please provide a value of type string.",
                        "examples": [
                          "CiAKGhIKJdealEffectivelyPageToken"
                        ],
                        "title": "Page Token",
                        "type": "string"
                      },
                      "thread_id": {
                        "description": "Unique ID of the thread, obtainable from actions like 'listThreads' or 'fetchEmails'. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "xsdfe3264vrfw"
                        ],
                        "title": "Thread Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "The email address of the user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Retrieves messages from a Gmail thread using its `thread_id`, where the thread must be accessible by the specified `user_id`.",
                    "display_description": "Retrieves messages from a Gmail thread using its `thread_id`, where the thread must be accessible by the specified `user_id`.",
                    "display_name": "Fetch Message by Thread ID",
                    "name": "gmail_fetch_message_by_thread_id",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_FETCH_MESSAGE_BY_THREAD_ID"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_forward_message_Forward email message_10",
                    "args": {
                      "additional_text": {
                        "default": null,
                        "description": "Optional additional text to include before the forwarded content. Please provide a value of type string.",
                        "examples": [
                          "Please see the forwarded message below."
                        ],
                        "title": "Additional Text",
                        "type": "string"
                      },
                      "message_id": {
                        "description": "ID of the message to forward, obtainable from actions like 'List Messages'. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "17f45ec49a9c3f1b"
                        ],
                        "title": "Message Id",
                        "type": "string"
                      },
                      "recipient_email": {
                        "description": "Email address to forward the message to. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "john.doe@example.com"
                        ],
                        "title": "Recipient Email",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Forward an existing Gmail message to specified recipients, preserving original body and attachments.",
                    "display_description": "Forward an existing Gmail message to specified recipients, preserving original body and attachments.",
                    "display_name": "Forward email message",
                    "name": "gmail_forward_message",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_FORWARD_MESSAGE"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_get_attachment_Get Gmail attachment_11",
                    "args": {
                      "attachment_id": {
                        "description": "ID of the attachment to retrieve. Make sure that attachment_id is passed and is valid, not a placeholder or NULL. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "A_PART0.1_18exampleAttachmentId7f9"
                        ],
                        "title": "Attachment Id",
                        "type": "string"
                      },
                      "file_name": {
                        "description": "Desired filename for the downloaded attachment. Make sure that file_name is passed. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "invoice.pdf",
                          "report.docx"
                        ],
                        "title": "File Name",
                        "type": "string"
                      },
                      "message_id": {
                        "description": "Immutable ID of the message containing the attachment. Make sure that message_id is passed and is valid, not a placeholder or NULL. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "18exampleMessageId7f9"
                        ],
                        "title": "Message Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address ('me' for authenticated user). Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Retrieves a specific attachment by ID from a message in a user's Gmail mailbox, requiring valid message and attachment IDs.",
                    "display_description": "Retrieves a specific attachment by ID from a message in a user's Gmail mailbox, requiring valid message and attachment IDs.",
                    "display_name": "Get Gmail attachment",
                    "name": "gmail_get_attachment",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_GET_ATTACHMENT"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_get_contacts_Get contacts_12",
                    "args": {
                      "include_other_contacts": {
                        "default": true,
                        "description": "Include 'Other Contacts' (interacted with but not explicitly saved) in addition to regular contacts; if true, fetches from both endpoints and merges results. Please provide a value of type boolean.",
                        "examples": [],
                        "title": "Include Other Contacts",
                        "type": "boolean"
                      },
                      "page_token": {
                        "default": null,
                        "description": "Token to retrieve a specific page of results, obtained from 'nextPageToken' in a previous response. Please provide a value of type string.",
                        "examples": [],
                        "title": "Page Token",
                        "type": "string"
                      },
                      "person_fields": {
                        "default": "emailAddresses,names,birthdays,genders",
                        "description": "Comma-separated person fields to retrieve for each contact (e.g., 'names,emailAddresses'). Please provide a value of type string.",
                        "examples": [
                          "addresses",
                          "ageRanges",
                          "biographies",
                          "birthdays",
                          "coverPhotos",
                          "emailAddresses",
                          "events",
                          "genders",
                          "imClients",
                          "interests",
                          "locales",
                          "memberships",
                          "metadata",
                          "names",
                          "nicknames",
                          "occupations",
                          "organizations",
                          "phoneNumbers",
                          "photos",
                          "relations",
                          "residences",
                          "sipAddresses",
                          "skills",
                          "urls",
                          "userDefined"
                        ],
                        "title": "Person Fields",
                        "type": "string"
                      },
                      "resource_name": {
                        "default": "people/me",
                        "description": "Identifier for the person resource whose connections are listed; use 'people/me' for the authenticated user. Please provide a value of type string.",
                        "examples": [],
                        "title": "Resource Name",
                        "type": "string"
                      }
                    },
                    "description": "Fetches contacts (connections) for the authenticated Google account, allowing selection of specific data fields and pagination.",
                    "display_description": "Fetches contacts (connections) for the authenticated Google account, allowing selection of specific data fields and pagination.",
                    "display_name": "Get contacts",
                    "name": "gmail_get_contacts",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_GET_CONTACTS"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_get_people_Get People_13",
                    "args": {
                      "other_contacts": {
                        "default": false,
                        "description": "If true, retrieves 'Other Contacts' (people interacted with but not explicitly saved), ignoring `resource_name` and enabling pagination/sync. If false, retrieves information for the single person specified by `resource_name`. Please provide a value of type boolean.",
                        "examples": [],
                        "title": "Other Contacts",
                        "type": "boolean"
                      },
                      "page_size": {
                        "default": 10,
                        "description": "The number of 'Other Contacts' to return per page. Applicable only when `other_contacts` is true. Please provide a value of type integer.",
                        "examples": [],
                        "title": "Page Size",
                        "type": "integer"
                      },
                      "page_token": {
                        "default": "",
                        "description": "An opaque token from a previous response to retrieve the next page of 'Other Contacts' results. Applicable only when `other_contacts` is true and paginating. Please provide a value of type string.",
                        "examples": [],
                        "title": "Page Token",
                        "type": "string"
                      },
                      "person_fields": {
                        "default": "emailAddresses,names,birthdays,genders",
                        "description": "A comma-separated field mask to restrict which fields on the person (or persons) are returned. Consult the Google People API documentation for a comprehensive list of valid fields. Please provide a value of type string.",
                        "examples": [
                          "names,emailAddresses",
                          "emailAddresses,names,birthdays,genders",
                          "addresses,phoneNumbers,metadata"
                        ],
                        "title": "Person Fields",
                        "type": "string"
                      },
                      "resource_name": {
                        "default": "people/me",
                        "description": "Resource name identifying the person for whom to retrieve information (like the authenticated user or a specific contact). Used only when `other_contacts` is false. Please provide a value of type string.",
                        "examples": [
                          "people/me",
                          "people/c12345678901234567890",
                          "people/102345678901234567890"
                        ],
                        "title": "Resource Name",
                        "type": "string"
                      },
                      "sync_token": {
                        "default": "",
                        "description": "A token from a previous 'Other Contacts' list call to retrieve only changes since the last sync; leave empty for an initial full sync. Applicable only when `other_contacts` is true. Please provide a value of type string.",
                        "examples": [],
                        "title": "Sync Token",
                        "type": "string"
                      }
                    },
                    "description": "Retrieves either a specific person's details (using `resource_name`) or lists 'Other Contacts' (if `other_contacts` is true), with `person_fields` specifying the data to return.",
                    "display_description": "Retrieves either a specific person's details (using `resource_name`) or lists 'Other Contacts' (if `other_contacts` is true), with `person_fields` specifying the data to return.",
                    "display_name": "Get People",
                    "name": "gmail_get_people",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_GET_PEOPLE"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_get_profile_Get Profile_14",
                    "args": {
                      "user_id": {
                        "default": "me",
                        "description": "The email address of the Gmail user whose profile is to be retrieved, or the special value 'me' to indicate the currently authenticated user. Please provide a value of type string.",
                        "examples": [
                          "user@example.com",
                          "me"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Retrieves key Gmail profile information (email address, message/thread totals, history ID) for a user.",
                    "display_description": "Retrieves key Gmail profile information (email address, message/thread totals, history ID) for a user.",
                    "display_name": "Get Profile",
                    "name": "gmail_get_profile",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_GET_PROFILE"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_list_drafts_List drafts_15",
                    "args": {
                      "max_results": {
                        "default": 1,
                        "description": "Maximum number of drafts to return per page. Please provide a value of type integer.",
                        "examples": [
                          10,
                          100,
                          500
                        ],
                        "title": "Max Results",
                        "type": "integer"
                      },
                      "page_token": {
                        "default": "",
                        "description": "Token from a previous response to retrieve a specific page of drafts. Please provide a value of type string.",
                        "examples": [
                          "CiaKJDhWSE5UURE9PSIsImMiOiJhYmMxMjMifQ=="
                        ],
                        "title": "Page Token",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's mailbox ID; use 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      },
                      "verbose": {
                        "default": false,
                        "description": "If true, fetches full draft details including subject, sender, recipient, body, and timestamp. If false, returns only draft IDs (faster). Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Verbose",
                        "type": "boolean"
                      }
                    },
                    "description": "Retrieves a paginated list of email drafts from a user's Gmail account. Use verbose=true to get full draft details including subject, body, sender, and timestamp.",
                    "display_description": "Retrieves a paginated list of email drafts from a user's Gmail account. Use verbose=true to get full draft details including subject, body, sender, and timestamp.",
                    "display_name": "List drafts",
                    "name": "gmail_list_drafts",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_LIST_DRAFTS"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_list_history_List Gmail history_16",
                    "args": {
                      "history_types": {
                        "default": null,
                        "description": "Filter by specific history types. Allowed values: messageAdded, messageDeleted, labelAdded, labelRemoved.",
                        "examples": [
                          [
                            "messageAdded",
                            "labelRemoved"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "History Types",
                        "type": "array"
                      },
                      "label_id": {
                        "default": null,
                        "description": "Only return history records involving messages with this label ID. Please provide a value of type string.",
                        "examples": [
                          "INBOX"
                        ],
                        "title": "Label Id",
                        "type": "string"
                      },
                      "max_results": {
                        "default": 100,
                        "description": "Maximum number of history records to return. Default is 100; max is 500. Please provide a value of type integer.",
                        "examples": [
                          100,
                          500
                        ],
                        "title": "Max Results",
                        "type": "integer"
                      },
                      "page_token": {
                        "default": null,
                        "description": "Token to retrieve a specific page of results. Please provide a value of type string.",
                        "examples": [
                          "ABCDEF123456"
                        ],
                        "title": "Page Token",
                        "type": "string"
                      },
                      "start_history_id": {
                        "description": "Required. Returns history records after this ID. If the ID is invalid or too old, the API returns 404. Perform a full sync in that case. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "1234567890"
                        ],
                        "title": "Start History Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "The user's email address. Use 'me' to specify the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Tool to list Gmail mailbox change history since a known startHistoryId. Use when performing incremental mailbox syncs to fetch only new changes.",
                    "display_description": "Tool to list Gmail mailbox change history since a known startHistoryId. Use when performing incremental mailbox syncs to fetch only new changes.",
                    "display_name": "List Gmail history",
                    "name": "gmail_list_history",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_LIST_HISTORY"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_list_labels_List Gmail labels_17",
                    "args": {
                      "user_id": {
                        "default": "me",
                        "description": "Identifies the Gmail account (owner's email or 'me' for authenticated user) for which labels will be listed. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Retrieves a list of all system and user-created labels for the specified Gmail account.",
                    "display_description": "Retrieves a list of all system and user-created labels for the specified Gmail account.",
                    "display_name": "List Gmail labels",
                    "name": "gmail_list_labels",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_LIST_LABELS"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_list_threads_List threads_18",
                    "args": {
                      "max_results": {
                        "default": 10,
                        "description": "Maximum number of threads to return. Please provide a value of type integer.",
                        "examples": [
                          "10",
                          "50",
                          "100"
                        ],
                        "title": "Max Results",
                        "type": "integer"
                      },
                      "page_token": {
                        "default": "",
                        "description": "Token from a previous response to retrieve a specific page of results; omit for the first page. Please provide a value of type string.",
                        "examples": [
                          "abcPageToken123"
                        ],
                        "title": "Page Token",
                        "type": "string"
                      },
                      "query": {
                        "default": "",
                        "description": "Filter for threads, using Gmail search query syntax (e.g., 'from:user@example.com is:unread'). Please provide a value of type string.",
                        "examples": [
                          "is:unread",
                          "from:john.doe@example.com",
                          "subject:important"
                        ],
                        "title": "Query",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "The user's email address or 'me' to specify the authenticated Gmail account. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      },
                      "verbose": {
                        "default": false,
                        "description": "If false, returns threads with basic fields (id, snippet, historyId). If true, returns threads with complete message details including headers, body, attachments, and metadata for each message in the thread. Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Verbose",
                        "type": "boolean"
                      }
                    },
                    "description": "Retrieves a list of email threads from a Gmail account, identified by `user_id` (email address or 'me'), supporting filtering and pagination.",
                    "display_description": "Retrieves a list of email threads from a Gmail account, identified by `user_id` (email address or 'me'), supporting filtering and pagination.",
                    "display_name": "List threads",
                    "name": "gmail_list_threads",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_LIST_THREADS"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_modify_thread_labels_Modify thread labels_19",
                    "args": {
                      "add_label_ids": {
                        "default": null,
                        "description": "List of label IDs to add to the thread; these labels must exist.",
                        "examples": [
                          "STARRED",
                          "INBOX"
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Add Label Ids",
                        "type": "array"
                      },
                      "remove_label_ids": {
                        "default": null,
                        "description": "List of label IDs to remove from the thread; these labels must exist.",
                        "examples": [
                          "IMPORTANT",
                          "CATEGORY_UPDATES"
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Remove Label Ids",
                        "type": "array"
                      },
                      "thread_id": {
                        "description": "Immutable ID of the thread to modify. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "18ea7715b619f09c"
                        ],
                        "title": "Thread Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "user@example.com",
                          "me"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Adds or removes specified existing label IDs from a Gmail thread, affecting all its messages; ensure the thread ID is valid.",
                    "display_description": "Adds or removes specified existing label IDs from a Gmail thread, affecting all its messages; ensure the thread ID is valid.",
                    "display_name": "Modify thread labels",
                    "name": "gmail_modify_thread_labels",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_MODIFY_THREAD_LABELS"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_move_to_trash_Move to Trash_20",
                    "args": {
                      "message_id": {
                        "description": "Identifier of the email message to move to trash. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "1875f42779f726f2"
                        ],
                        "title": "Message Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "user@example.com",
                          "me"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Moves an existing, non-deleted email message to the trash for the specified user.",
                    "display_description": "Moves an existing, non-deleted email message to the trash for the specified user.",
                    "display_name": "Move to Trash",
                    "name": "gmail_move_to_trash",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_MOVE_TO_TRASH"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_patch_label_Patch Label_21",
                    "args": {
                      "color": {
                        "$ref": "#/$defs/PatchLabelColor",
                        "default": null,
                        "description": "The color to assign to the label. Color is only available for labels that have their `type` set to `user`.",
                        "examples": []
                      },
                      "id": {
                        "description": "The ID of the label to update. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "LABEL_123"
                        ],
                        "title": "Id",
                        "type": "string"
                      },
                      "labelListVisibility": {
                        "default": null,
                        "description": "The visibility of the label in the label list in the Gmail web interface. Please provide a value of type string.",
                        "examples": [
                          "labelShow",
                          "labelShowIfUnread",
                          "labelHide"
                        ],
                        "title": "Labellistvisibility",
                        "type": "string"
                      },
                      "messageListVisibility": {
                        "default": null,
                        "description": "The visibility of messages with this label in the message list in the Gmail web interface. Please provide a value of type string.",
                        "examples": [
                          "show",
                          "hide"
                        ],
                        "title": "Messagelistvisibility",
                        "type": "string"
                      },
                      "name": {
                        "default": null,
                        "description": "The display name of the label. Please provide a value of type string.",
                        "examples": [
                          "My Updated Label"
                        ],
                        "title": "Name",
                        "type": "string"
                      },
                      "userId": {
                        "description": "The user's email address. The special value `me` can be used to indicate the authenticated user. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "Userid",
                        "type": "string"
                      }
                    },
                    "description": "Patches the specified label.",
                    "display_description": "Patches the specified label.",
                    "display_name": "Patch Label",
                    "name": "gmail_patch_label",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_PATCH_LABEL"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_remove_label_Remove label_22",
                    "args": {
                      "label_id": {
                        "description": "ID of the user-created label to be permanently deleted; must exist and not be a system label. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "Label_123",
                          "Label_xyz789"
                        ],
                        "title": "Label Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address or 'me' for the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Permanently deletes a specific, existing user-created Gmail label by its ID for a user; cannot delete system labels.",
                    "display_description": "Permanently deletes a specific, existing user-created Gmail label by its ID for a user; cannot delete system labels.",
                    "display_name": "Remove label",
                    "name": "gmail_remove_label",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_REMOVE_LABEL"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_reply_to_thread_Reply to email thread_23",
                    "args": {
                      "attachment": {
                        "default": null,
                        "description": "File to attach to the reply. Just Provide file path here",
                        "examples": [],
                        "title": "Attachment",
                        "type": "string"
                      },
                      "bcc": {
                        "default": [],
                        "description": "Blind Carbon Copy (BCC) recipients' email addresses. Atleast one of cc, bcc, or recipient_email must be provided.",
                        "examples": [
                          [
                            "bcc.recipient@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Bcc",
                        "type": "array"
                      },
                      "cc": {
                        "default": [],
                        "description": "Carbon Copy (CC) recipients' email addresses. Atleast one of cc, bcc, or recipient_email must be provided.",
                        "examples": [
                          [
                            "cc.recipient1@example.com",
                            "cc.recipient2@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Cc",
                        "type": "array"
                      },
                      "extra_recipients": {
                        "default": [],
                        "description": "Additional 'To' recipients' email addresses (not Cc or Bcc). Should only be used if recipient_email is also provided.",
                        "examples": [
                          [
                            "jane.doe@example.com",
                            "another.person@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Extra Recipients",
                        "type": "array"
                      },
                      "is_html": {
                        "default": false,
                        "description": "Indicates if `message_body` is HTML; if True, body must be valid HTML, if False, body should not contain HTML tags. Please provide a value of type boolean.",
                        "examples": [
                          true,
                          false
                        ],
                        "title": "Is Html",
                        "type": "boolean"
                      },
                      "message_body": {
                        "default": "",
                        "description": "Content of the reply message, either plain text or HTML. Please provide a value of type string.",
                        "examples": [
                          "Dear Sir, Nice talking to you. Yours respectfully, John"
                        ],
                        "title": "Message Body",
                        "type": "string"
                      },
                      "recipient_email": {
                        "default": null,
                        "description": "Primary recipient's email address. Required if cc and bcc is not provided, else can be optional. Use extra_recipients if you want to send to multiple recipients. Please provide a value of type string.",
                        "examples": [
                          "john@doe.com"
                        ],
                        "title": "Recipient Email",
                        "type": "string"
                      },
                      "thread_id": {
                        "description": "Identifier of the Gmail thread for the reply. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "x53r3vdevff"
                        ],
                        "title": "Thread Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "Identifier for the user sending the reply; 'me' refers to the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Sends a reply within a specific Gmail thread using the original thread's subject, requiring a valid `thread_id` and at least one of recipient_email, cc, or bcc must be provided. Supports attachments via the `attachment` parameter with valid `s3key`, `mimetype`, and `name`.",
                    "display_description": "Sends a reply within a specific Gmail thread using the original thread's subject, requiring a valid `thread_id` and at least one of recipient_email, cc, or bcc must be provided. Supports attachments via the `attachment` parameter with valid `s3key`, `mimetype`, and `name`.",
                    "display_name": "Reply to email thread",
                    "name": "gmail_reply_to_thread",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_REPLY_TO_THREAD"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_search_people_Search People_24",
                    "args": {
                      "other_contacts": {
                        "default": true,
                        "description": "When True, searches both saved contacts and 'Other Contacts' (people you've interacted with but not explicitly saved). Note: This restricts person_fields to only 'emailAddresses', 'names', 'phoneNumbers'. When False, searches only saved contacts but allows all person_fields including 'organizations', 'addresses', etc. Please provide a value of type boolean.",
                        "examples": [],
                        "title": "Other Contacts",
                        "type": "boolean"
                      },
                      "pageSize": {
                        "default": 10,
                        "description": "Maximum results to return; values >30 are capped to 30 by the API. Please provide a value of type integer.",
                        "examples": [],
                        "title": "Pagesize",
                        "type": "integer"
                      },
                      "person_fields": {
                        "default": "emailAddresses,names,phoneNumbers",
                        "description": "Comma-separated fields to return (e.g., 'names,emailAddresses'). When 'other_contacts' is true, only 'emailAddresses', 'names', 'phoneNumbers' are allowed. For full field access including 'organizations', set 'other_contacts' to false. Please provide a value of type string.",
                        "examples": [
                          "addresses",
                          "ageRanges",
                          "biographies",
                          "birthdays",
                          "coverPhotos",
                          "emailAddresses",
                          "events",
                          "genders",
                          "imClients",
                          "interests",
                          "locales",
                          "memberships",
                          "metadata",
                          "names",
                          "nicknames",
                          "occupations",
                          "organizations",
                          "phoneNumbers",
                          "photos",
                          "relations",
                          "residences",
                          "sipAddresses",
                          "skills",
                          "urls",
                          "userDefined"
                        ],
                        "title": "Person Fields",
                        "type": "string"
                      },
                      "query": {
                        "description": "Matches contact names, nicknames, email addresses, phone numbers, and organization fields. Please provide a value of type string. This parameter is required.",
                        "examples": [],
                        "title": "Query",
                        "type": "string"
                      }
                    },
                    "description": "Searches contacts by matching the query against names, nicknames, emails, phone numbers, and organizations, optionally including 'Other Contacts'.",
                    "display_description": "Searches contacts by matching the query against names, nicknames, emails, phone numbers, and organizations, optionally including 'Other Contacts'.",
                    "display_name": "Search People",
                    "name": "gmail_search_people",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_SEARCH_PEOPLE"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_send_draft_Send Draft_25",
                    "args": {
                      "draft_id": {
                        "description": "The ID of the draft to send. Make sure that the draft ID is valid and not a placeholder. You can use GMAIL_LIST_DRAFTS or GMAIL_CREATE_EMAIL_DRAFT to get the draft ID, if you don't have it. Please provide a value of type string. This parameter is required.",
                        "examples": [
                          "r-xxxxxxxxxxxxxxxxx"
                        ],
                        "title": "Draft Id",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "The user's email address. The special value `me` can be used to indicate the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "me",
                          "user@example.com"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Sends the specified, existing draft to the recipients in the To, Cc, and Bcc headers.",
                    "display_description": "Sends the specified, existing draft to the recipients in the To, Cc, and Bcc headers.",
                    "display_name": "Send Draft",
                    "name": "gmail_send_draft",
                    "readonly": true,
                    "status": false,
                    "tags": [
                      "GMAIL_SEND_DRAFT"
                    ]
                  },
                  {
                    "_uniqueId": "gmail_send_email_Send Email_26",
                    "args": {
                      "attachment": {
                        "default": null,
                        "description": "File to attach; ensure `s3key`, `mimetype`, and `name` are set if provided. Omit or set to null for no attachment.",
                        "examples": [],
                        "title": "Attachment",
                        "type": "string"
                      },
                      "bcc": {
                        "default": [],
                        "description": "Blind Carbon Copy (BCC) recipients' email addresses. At least one of 'recipient_email', 'cc', or 'bcc' must be provided.",
                        "examples": [
                          [
                            "auditor@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Bcc",
                        "type": "array"
                      },
                      "body": {
                        "default": null,
                        "description": "Email content (plain text or HTML). Either subject or body must be provided for the email to be sent. If HTML, `is_html` must be `True`. Please provide a value of type string.",
                        "examples": [
                          "Hello team, let's discuss the project updates tomorrow.",
                          "<h1>Welcome!</h1><p>Thank you for signing up.</p>",
                          ""
                        ],
                        "title": "Body",
                        "type": "string"
                      },
                      "cc": {
                        "default": [],
                        "description": "Carbon Copy (CC) recipients' email addresses. At least one of 'recipient_email', 'cc', or 'bcc' must be provided.",
                        "examples": [
                          [
                            "manager@example.com",
                            "teamlead@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Cc",
                        "type": "array"
                      },
                      "extra_recipients": {
                        "default": [],
                        "description": "Additional 'To' recipients' email addresses (not Cc or Bcc). Should only be used if recipient_email is also provided.",
                        "examples": [
                          [
                            "jane.doe@example.com",
                            "support@example.com"
                          ]
                        ],
                        "items": {
                          "type": "string"
                        },
                        "title": "Extra Recipients",
                        "type": "array"
                      },
                      "is_html": {
                        "default": false,
                        "description": "Set to `True` if the email body contains HTML tags. Please provide a value of type boolean.",
                        "examples": [],
                        "title": "Is Html",
                        "type": "boolean"
                      },
                      "recipient_email": {
                        "default": null,
                        "description": "Primary recipient's email address. At least one of 'recipient_email', 'cc', or 'bcc' must be provided. Use extra_recipients if you want to send to multiple recipients. Please provide a value of type string.",
                        "examples": [
                          "john@doe.com"
                        ],
                        "title": "Recipient Email",
                        "type": "string"
                      },
                      "subject": {
                        "default": null,
                        "description": "Subject line of the email. Either subject or body must be provided for the email to be sent. Please provide a value of type string.",
                        "examples": [
                          "Project Update Meeting",
                          "Your Weekly Newsletter"
                        ],
                        "title": "Subject",
                        "type": "string"
                      },
                      "user_id": {
                        "default": "me",
                        "description": "User's email address; the literal 'me' refers to the authenticated user. Please provide a value of type string.",
                        "examples": [
                          "user@example.com",
                          "me"
                        ],
                        "title": "User Id",
                        "type": "string"
                      }
                    },
                    "description": "Sends an email via Gmail API using the authenticated user's Google profile display name. At least one of recipient_email, cc, or bcc must be provided. At least one of subject or body must be provided. Requires `is_html=True` if the body contains HTML and valid `s3key`, `mimetype`, `name` for any attachment.",
                    "display_description": "Sends an email via Gmail API using the authenticated user's Google profile display name. At least one of recipient_email, cc, or bcc must be provided. At least one of subject or body must be provided. Requires `is_html=True` if the body contains HTML and valid `s3key`, `mimetype`, `name` for any attachment.",
                    "display_name": "Send Email",
                    "name": "gmail_send_email",
                    "readonly": true,
                    "status": true,
                    "tags": [
                      "GMAIL_SEND_EMAIL"
                    ]
                  }
                ]
              },
              "username": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Username",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "username",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "verification_token": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "Verification Token",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "verification_token",
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": false,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              }
            },
            "tool_mode": true
          },
          "showNode": true,
          "type": "ComposioGmailAPIComponent"
        },
        "dragging": false,
        "id": "ComposioGmailAPIComponent-Rc6PI",
        "measured": {
          "height": 335,
          "width": 320
        },
        "position": {
          "x": 905.4324206921619,
          "y": 503.7268331679617
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "ChatInput-0R8KM",
          "node": {
            "base_classes": [
              "Message"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Get chat inputs from the Playground.",
            "display_name": "Chat Input",
            "documentation": "https://docs.langflow.org/chat-input-and-output",
            "edited": false,
            "field_order": [
              "input_value",
              "should_store_message",
              "sender",
              "sender_name",
              "session_id",
              "context_id",
              "files"
            ],
            "frozen": false,
            "icon": "MessagesSquare",
            "legacy": false,
            "lf_version": "1.7.0",
            "metadata": {
              "code_hash": "7a26c54d89ed",
              "dependencies": {
                "dependencies": [
                  {
                    "name": "lfx",
                    "version": null
                  }
                ],
                "total_dependencies": 1
              },
              "module": "custom_components.chat_input"
            },
            "minimized": true,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Chat Message",
                "group_outputs": false,
                "loop_types": null,
                "method": "message_response",
                "name": "message",
                "options": null,
                "required_inputs": null,
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from lfx.base.data.utils import IMG_FILE_TYPES, TEXT_FILE_TYPES\nfrom lfx.base.io.chat import ChatComponent\nfrom lfx.inputs.inputs import BoolInput\nfrom lfx.io import (\n    DropdownInput,\n    FileInput,\n    MessageTextInput,\n    MultilineInput,\n    Output,\n)\nfrom lfx.schema.message import Message\nfrom lfx.utils.constants import (\n    MESSAGE_SENDER_AI,\n    MESSAGE_SENDER_NAME_USER,\n    MESSAGE_SENDER_USER,\n)\n\n\nclass ChatInput(ChatComponent):\n    display_name = \"Chat Input\"\n    description = \"Get chat inputs from the Playground.\"\n    documentation: str = \"https://docs.langflow.org/chat-input-and-output\"\n    icon = \"MessagesSquare\"\n    name = \"ChatInput\"\n    minimized = True\n\n    inputs = [\n        MultilineInput(\n            name=\"input_value\",\n            display_name=\"Input Text\",\n            value=\"\",\n            info=\"Message to be passed as input.\",\n            input_types=[],\n        ),\n        BoolInput(\n            name=\"should_store_message\",\n            display_name=\"Store Messages\",\n            info=\"Store the message in the history.\",\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"sender\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER],\n            value=MESSAGE_SENDER_USER,\n            info=\"Type of sender.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Name of the sender.\",\n            value=MESSAGE_SENDER_NAME_USER,\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"context_id\",\n            display_name=\"Context ID\",\n            info=\"The context ID of the chat. Adds an extra layer to the local memory.\",\n            value=\"\",\n            advanced=True,\n        ),\n        FileInput(\n            name=\"files\",\n            display_name=\"Files\",\n            file_types=TEXT_FILE_TYPES + IMG_FILE_TYPES,\n            info=\"Files to be sent with the message.\",\n            advanced=True,\n            is_list=True,\n            temp_file=True,\n        ),\n    ]\n    outputs = [\n        Output(display_name=\"Chat Message\", name=\"message\", method=\"message_response\"),\n    ]\n\n    async def message_response(self) -> Message:\n        # Ensure files is a list and filter out empty/None values\n        files = self.files if self.files else []\n        if files and not isinstance(files, list):\n            files = [files]\n        # Filter out None/empty values\n        files = [f for f in files if f is not None and f != \"\"]\n\n        session_id = self.session_id or self.graph.session_id or \"\"\n        message = await Message.create(\n            text=self.input_value,\n            sender=self.sender,\n            sender_name=self.sender_name,\n            session_id=session_id,\n            context_id=self.context_id,\n            files=files,\n        )\n        if session_id and isinstance(message, Message) and self.should_store_message:\n            stored_message = await self.send_message(\n                message,\n            )\n            self.message.value = stored_message\n            message = stored_message\n\n        self.status = message\n        return message\n"
              },
              "context_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Context ID",
                "dynamic": false,
                "info": "The context ID of the chat. Adds an extra layer to the local memory.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "context_id",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "files": {
                "_input_type": "FileInput",
                "advanced": true,
                "display_name": "Files",
                "dynamic": false,
                "fileTypes": [
                  "csv",
                  "json",
                  "pdf",
                  "txt",
                  "md",
                  "mdx",
                  "yaml",
                  "yml",
                  "xml",
                  "html",
                  "htm",
                  "docx",
                  "py",
                  "sh",
                  "sql",
                  "js",
                  "ts",
                  "tsx",
                  "jpg",
                  "jpeg",
                  "png",
                  "bmp",
                  "image"
                ],
                "file_path": "",
                "info": "Files to be sent with the message.",
                "list": true,
                "list_add_label": "Add More",
                "name": "files",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "temp_file": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "file",
                "value": ""
              },
              "input_value": {
                "_input_type": "MultilineInput",
                "advanced": false,
                "ai_enabled": false,
                "copy_field": false,
                "display_name": "Input Text",
                "dynamic": false,
                "info": "Message to be passed as input.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "multiline": true,
                "name": "input_value",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "sender": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Sender Type",
                "dynamic": false,
                "external_options": {},
                "info": "Type of sender.",
                "name": "sender",
                "options": [
                  "Machine",
                  "User"
                ],
                "options_metadata": [],
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": "User"
              },
              "sender_name": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Sender Name",
                "dynamic": false,
                "info": "Name of the sender.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "sender_name",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": "User"
              },
              "session_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Session ID",
                "dynamic": false,
                "info": "The session ID of the chat. If empty, the current session ID parameter will be used.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "session_id",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "should_store_message": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Store Messages",
                "dynamic": false,
                "info": "Store the message in the history.",
                "list": false,
                "list_add_label": "Add More",
                "name": "should_store_message",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              }
            },
            "tool_mode": false
          },
          "showNode": false,
          "type": "ChatInput"
        },
        "dragging": false,
        "id": "ChatInput-0R8KM",
        "measured": {
          "height": 48,
          "width": 192
        },
        "position": {
          "x": 1475.9159117483173,
          "y": 85.77118774154984
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "ChatOutput-yHar7",
          "node": {
            "base_classes": [
              "Message"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Display a chat message in the Playground.",
            "display_name": "Chat Output",
            "documentation": "https://docs.langflow.org/chat-input-and-output",
            "edited": false,
            "field_order": [
              "input_value",
              "should_store_message",
              "sender",
              "sender_name",
              "session_id",
              "context_id",
              "data_template",
              "clean_data"
            ],
            "frozen": false,
            "icon": "MessagesSquare",
            "legacy": false,
            "lf_version": "1.7.0",
            "metadata": {
              "code_hash": "8c87e536cca4",
              "dependencies": {
                "dependencies": [
                  {
                    "name": "orjson",
                    "version": "3.10.15"
                  },
                  {
                    "name": "fastapi",
                    "version": "0.123.0"
                  },
                  {
                    "name": "lfx",
                    "version": null
                  }
                ],
                "total_dependencies": 3
              },
              "module": "custom_components.chat_output"
            },
            "minimized": true,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Output Message",
                "group_outputs": false,
                "loop_types": null,
                "method": "message_response",
                "name": "message",
                "options": null,
                "required_inputs": null,
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_type": "Component",
              "clean_data": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Basic Clean Data",
                "dynamic": false,
                "info": "Whether to clean data before converting to string.",
                "list": false,
                "list_add_label": "Add More",
                "name": "clean_data",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              },
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "from collections.abc import Generator\nfrom typing import Any\n\nimport orjson\nfrom fastapi.encoders import jsonable_encoder\n\nfrom lfx.base.io.chat import ChatComponent\nfrom lfx.helpers.data import safe_convert\nfrom lfx.inputs.inputs import BoolInput, DropdownInput, HandleInput, MessageTextInput\nfrom lfx.schema.data import Data\nfrom lfx.schema.dataframe import DataFrame\nfrom lfx.schema.message import Message\nfrom lfx.schema.properties import Source\nfrom lfx.template.field.base import Output\nfrom lfx.utils.constants import (\n    MESSAGE_SENDER_AI,\n    MESSAGE_SENDER_NAME_AI,\n    MESSAGE_SENDER_USER,\n)\n\n\nclass ChatOutput(ChatComponent):\n    display_name = \"Chat Output\"\n    description = \"Display a chat message in the Playground.\"\n    documentation: str = \"https://docs.langflow.org/chat-input-and-output\"\n    icon = \"MessagesSquare\"\n    name = \"ChatOutput\"\n    minimized = True\n\n    inputs = [\n        HandleInput(\n            name=\"input_value\",\n            display_name=\"Inputs\",\n            info=\"Message to be passed as output.\",\n            input_types=[\"Data\", \"DataFrame\", \"Message\"],\n            required=True,\n        ),\n        BoolInput(\n            name=\"should_store_message\",\n            display_name=\"Store Messages\",\n            info=\"Store the message in the history.\",\n            value=True,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"sender\",\n            display_name=\"Sender Type\",\n            options=[MESSAGE_SENDER_AI, MESSAGE_SENDER_USER],\n            value=MESSAGE_SENDER_AI,\n            advanced=True,\n            info=\"Type of sender.\",\n        ),\n        MessageTextInput(\n            name=\"sender_name\",\n            display_name=\"Sender Name\",\n            info=\"Name of the sender.\",\n            value=MESSAGE_SENDER_NAME_AI,\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"session_id\",\n            display_name=\"Session ID\",\n            info=\"The session ID of the chat. If empty, the current session ID parameter will be used.\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"context_id\",\n            display_name=\"Context ID\",\n            info=\"The context ID of the chat. Adds an extra layer to the local memory.\",\n            value=\"\",\n            advanced=True,\n        ),\n        MessageTextInput(\n            name=\"data_template\",\n            display_name=\"Data Template\",\n            value=\"{text}\",\n            advanced=True,\n            info=\"Template to convert Data to Text. If left empty, it will be dynamically set to the Data's text key.\",\n        ),\n        BoolInput(\n            name=\"clean_data\",\n            display_name=\"Basic Clean Data\",\n            value=True,\n            advanced=True,\n            info=\"Whether to clean data before converting to string.\",\n        ),\n    ]\n    outputs = [\n        Output(\n            display_name=\"Output Message\",\n            name=\"message\",\n            method=\"message_response\",\n        ),\n    ]\n\n    def _build_source(self, id_: str | None, display_name: str | None, source: str | None) -> Source:\n        source_dict = {}\n        if id_:\n            source_dict[\"id\"] = id_\n        if display_name:\n            source_dict[\"display_name\"] = display_name\n        if source:\n            # Handle case where source is a ChatOpenAI object\n            if hasattr(source, \"model_name\"):\n                source_dict[\"source\"] = source.model_name\n            elif hasattr(source, \"model\"):\n                source_dict[\"source\"] = str(source.model)\n            else:\n                source_dict[\"source\"] = str(source)\n        return Source(**source_dict)\n\n    async def message_response(self) -> Message:\n        # First convert the input to string if needed\n        text = self.convert_to_string()\n\n        # Get source properties\n        source, _, display_name, source_id = self.get_properties_from_source_component()\n\n        # Create or use existing Message object\n        if isinstance(self.input_value, Message) and not self.is_connected_to_chat_input():\n            message = self.input_value\n            # Update message properties\n            message.text = text\n            # Preserve existing session_id from the incoming message if it exists\n            existing_session_id = message.session_id\n        else:\n            message = Message(text=text)\n            existing_session_id = None\n\n        # Set message properties\n        message.sender = self.sender\n        message.sender_name = self.sender_name\n        # Preserve session_id from incoming message, or use component/graph session_id\n        message.session_id = (\n            self.session_id or existing_session_id or (self.graph.session_id if hasattr(self, \"graph\") else None) or \"\"\n        )\n        message.context_id = self.context_id\n        message.flow_id = self.graph.flow_id if hasattr(self, \"graph\") else None\n        message.properties.source = self._build_source(source_id, display_name, source)\n\n        # Store message if needed\n        if message.session_id and self.should_store_message:\n            stored_message = await self.send_message(message)\n            self.message.value = stored_message\n            message = stored_message\n\n        self.status = message\n        return message\n\n    def _serialize_data(self, data: Data) -> str:\n        \"\"\"Serialize Data object to JSON string.\"\"\"\n        # Convert data.data to JSON-serializable format\n        serializable_data = jsonable_encoder(data.data)\n        # Serialize with orjson, enabling pretty printing with indentation\n        json_bytes = orjson.dumps(serializable_data, option=orjson.OPT_INDENT_2)\n        # Convert bytes to string and wrap in Markdown code blocks\n        return \"```json\\n\" + json_bytes.decode(\"utf-8\") + \"\\n```\"\n\n    def _validate_input(self) -> None:\n        \"\"\"Validate the input data and raise ValueError if invalid.\"\"\"\n        if self.input_value is None:\n            msg = \"Input data cannot be None\"\n            raise ValueError(msg)\n        if isinstance(self.input_value, list) and not all(\n            isinstance(item, Message | Data | DataFrame | str) for item in self.input_value\n        ):\n            invalid_types = [\n                type(item).__name__\n                for item in self.input_value\n                if not isinstance(item, Message | Data | DataFrame | str)\n            ]\n            msg = f\"Expected Data or DataFrame or Message or str, got {invalid_types}\"\n            raise TypeError(msg)\n        if not isinstance(\n            self.input_value,\n            Message | Data | DataFrame | str | list | Generator | type(None),\n        ):\n            type_name = type(self.input_value).__name__\n            msg = f\"Expected Data or DataFrame or Message or str, Generator or None, got {type_name}\"\n            raise TypeError(msg)\n\n    def convert_to_string(self) -> str | Generator[Any, None, None]:\n        \"\"\"Convert input data to string with proper error handling.\"\"\"\n        self._validate_input()\n        if isinstance(self.input_value, list):\n            clean_data: bool = getattr(self, \"clean_data\", False)\n            return \"\\n\".join([safe_convert(item, clean_data=clean_data) for item in self.input_value])\n        if isinstance(self.input_value, Generator):\n            return self.input_value\n        return safe_convert(self.input_value)\n"
              },
              "context_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Context ID",
                "dynamic": false,
                "info": "The context ID of the chat. Adds an extra layer to the local memory.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "context_id",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "data_template": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Data Template",
                "dynamic": false,
                "info": "Template to convert Data to Text. If left empty, it will be dynamically set to the Data's text key.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "data_template",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": "{text}"
              },
              "input_value": {
                "_input_type": "HandleInput",
                "advanced": false,
                "display_name": "Inputs",
                "dynamic": false,
                "info": "Message to be passed as output.",
                "input_types": [
                  "Data",
                  "DataFrame",
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "name": "input_value",
                "override_skip": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "other",
                "value": ""
              },
              "sender": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Sender Type",
                "dynamic": false,
                "external_options": {},
                "info": "Type of sender.",
                "name": "sender",
                "options": [
                  "Machine",
                  "User"
                ],
                "options_metadata": [],
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": "Machine"
              },
              "sender_name": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Sender Name",
                "dynamic": false,
                "info": "Name of the sender.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "sender_name",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": "AI"
              },
              "session_id": {
                "_input_type": "MessageTextInput",
                "advanced": true,
                "display_name": "Session ID",
                "dynamic": false,
                "info": "The session ID of the chat. If empty, the current session ID parameter will be used.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "session_id",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "should_store_message": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Store Messages",
                "dynamic": false,
                "info": "Store the message in the history.",
                "list": false,
                "list_add_label": "Add More",
                "name": "should_store_message",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              }
            },
            "tool_mode": false
          },
          "showNode": false,
          "type": "ChatOutput"
        },
        "dragging": false,
        "id": "ChatOutput-yHar7",
        "measured": {
          "height": 48,
          "width": 192
        },
        "position": {
          "x": 2149.802933216096,
          "y": 106.32775517805862
        },
        "selected": false,
        "type": "genericNode"
      },
      {
        "data": {
          "id": "Cuga-h25LW",
          "node": {
            "base_classes": [
              "Message"
            ],
            "beta": false,
            "conditional_paths": [],
            "custom_fields": {},
            "description": "Define the Cuga agent's instructions, then assign it a task.",
            "display_name": "Cuga",
            "documentation": "https://docs.langflow.org/bundles-cuga",
            "edited": false,
            "field_order": [
              "agent_llm",
              "max_tokens",
              "model_kwargs",
              "json_mode",
              "model_name",
              "openai_api_base",
              "api_key",
              "temperature",
              "seed",
              "max_retries",
              "timeout",
              "instructions",
              "n_messages",
              "tools",
              "input_value",
              "handle_parsing_errors",
              "verbose",
              "max_iterations",
              "agent_description",
              "add_current_date_tool",
              "lite_mode",
              "lite_mode_tool_threshold",
              "decomposition_strategy",
              "browser_enabled",
              "web_apps"
            ],
            "frozen": false,
            "icon": "bot",
            "last_updated": "2025-12-18T10:50:05.655Z",
            "legacy": false,
            "lf_version": "1.7.0",
            "metadata": {
              "code_hash": "35e838f89d13",
              "dependencies": {
                "dependencies": [
                  {
                    "name": "langchain_core",
                    "version": "0.3.80"
                  },
                  {
                    "name": "lfx",
                    "version": null
                  },
                  {
                    "name": "cuga",
                    "version": "0.2.6"
                  }
                ],
                "total_dependencies": 3
              },
              "module": "lfx.components.cuga.cuga_agent.CugaComponent"
            },
            "minimized": false,
            "output_types": [],
            "outputs": [
              {
                "allows_loop": false,
                "cache": true,
                "display_name": "Response",
                "group_outputs": false,
                "loop_types": null,
                "method": "message_response",
                "name": "response",
                "options": null,
                "required_inputs": null,
                "selected": "Message",
                "tool_mode": true,
                "types": [
                  "Message"
                ],
                "value": "__UNDEFINED__"
              }
            ],
            "pinned": false,
            "template": {
              "_frontend_node_flow_id": {
                "value": "af63ae2e-2804-4ab5-9259-4e337a09a401"
              },
              "_frontend_node_folder_id": {
                "value": "9d4e6e89-4355-4367-8927-de9e2800dfeb"
              },
              "_type": "Component",
              "add_current_date_tool": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Current Date",
                "dynamic": false,
                "info": "If true, will add a tool to the agent that returns the current date.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "add_current_date_tool",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              },
              "agent_description": {
                "_input_type": "MultilineInput",
                "advanced": true,
                "ai_enabled": false,
                "copy_field": false,
                "display_name": "Agent Description [Deprecated]",
                "dynamic": false,
                "info": "The description of the agent. This is only used when in Tool Mode. Defaults to 'A helpful assistant with access to the following tools:' and tools are added dynamically. This feature is deprecated and will be removed in future versions.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "multiline": true,
                "name": "agent_description",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": "A helpful assistant with access to the following tools:"
              },
              "agent_llm": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Language Model",
                "dynamic": false,
                "external_options": {},
                "info": "",
                "input_types": [],
                "name": "agent_llm",
                "options": [
                  "Anthropic",
                  "Google Generative AI",
                  "IBM watsonx.ai",
                  "Ollama",
                  "OpenAI",
                  "Custom"
                ],
                "options_metadata": [
                  {
                    "icon": "Anthropic"
                  },
                  {
                    "icon": "GoogleGenerativeAI"
                  },
                  {
                    "icon": "WatsonxAI"
                  },
                  {
                    "icon": "Ollama"
                  },
                  {
                    "icon": "OpenAI"
                  },
                  {
                    "icon": "brain"
                  }
                ],
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "selected_metadata": {
                  "icon": "WatsonxAI"
                },
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": "IBM watsonx.ai"
              },
              "api_key": {
                "_input_type": "SecretStrInput",
                "advanced": false,
                "display_name": "Watsonx API Key",
                "dynamic": false,
                "info": "The API Key to use for the model.",
                "input_types": [],
                "load_from_db": false,
                "name": "api_key",
                "override_skip": false,
                "password": true,
                "placeholder": "",
                "real_time_refresh": true,
                "required": false,
                "show": true,
                "title_case": false,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "base_url": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "watsonx API Endpoint",
                "dynamic": false,
                "external_options": {},
                "info": "The base URL of the API.",
                "input_types": [],
                "name": "base_url",
                "options": [
                  "https://us-south.ml.cloud.ibm.com",
                  "https://eu-de.ml.cloud.ibm.com",
                  "https://eu-gb.ml.cloud.ibm.com",
                  "https://au-syd.ml.cloud.ibm.com",
                  "https://jp-tok.ml.cloud.ibm.com",
                  "https://ca-tor.ml.cloud.ibm.com"
                ],
                "options_metadata": [],
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "required": true,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": "https://us-south.ml.cloud.ibm.com"
              },
              "browser_enabled": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Enable Browser",
                "dynamic": false,
                "info": "Toggle to enable a built-in browser tool for web scraping and searching.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "browser_enabled",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": false
              },
              "code": {
                "advanced": true,
                "dynamic": true,
                "fileTypes": [],
                "file_path": "",
                "info": "",
                "input_types": [],
                "list": false,
                "load_from_db": false,
                "multiline": true,
                "name": "code",
                "password": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "type": "code",
                "value": "import asyncio\nimport json\nimport traceback\nimport uuid\nfrom collections.abc import AsyncIterator\nfrom typing import TYPE_CHECKING, Any, cast\n\nfrom langchain_core.agents import AgentFinish\nfrom langchain_core.messages import AIMessage, HumanMessage\nfrom langchain_core.tools import StructuredTool\n\nfrom lfx.base.agents.agent import LCToolsAgentComponent\nfrom lfx.base.models.model_input_constants import (\n    ALL_PROVIDER_FIELDS,\n    MODEL_DYNAMIC_UPDATE_FIELDS,\n    MODEL_PROVIDERS,\n    MODEL_PROVIDERS_DICT,\n    MODELS_METADATA,\n)\nfrom lfx.base.models.model_utils import get_model_name\nfrom lfx.components.helpers import CurrentDateComponent\nfrom lfx.components.langchain_utilities.tool_calling import ToolCallingAgentComponent\nfrom lfx.components.models_and_agents.memory import MemoryComponent\nfrom lfx.custom.custom_component.component import _get_component_toolkit\nfrom lfx.custom.utils import update_component_build_config\nfrom lfx.field_typing import Tool\nfrom lfx.io import BoolInput, DropdownInput, IntInput, MultilineInput, Output\nfrom lfx.log.logger import logger\nfrom lfx.schema.dotdict import dotdict\nfrom lfx.schema.message import Message\n\nif TYPE_CHECKING:\n    from lfx.schema.log import SendMessageFunctionType\n\n\ndef set_advanced_true(component_input):\n    \"\"\"Set the advanced flag to True for a component input.\n\n    Args:\n        component_input: The component input to modify\n\n    Returns:\n        The modified component input with advanced=True\n    \"\"\"\n    component_input.advanced = True\n    return component_input\n\n\nMODEL_PROVIDERS_LIST = [\"OpenAI\"]\n\n\nclass CugaComponent(ToolCallingAgentComponent):\n    \"\"\"Cuga Agent Component for advanced AI task execution.\n\n    The Cuga component is an advanced AI agent that can execute complex tasks using\n    various tools and browser automation. It supports custom instructions, web applications,\n    and API interactions.\n\n    Attributes:\n        display_name: Human-readable name for the component\n        description: Brief description of the component's purpose\n        documentation: URL to component documentation\n        icon: Icon identifier for the UI\n        name: Internal component name\n    \"\"\"\n\n    display_name: str = \"Cuga\"\n    description: str = \"Define the Cuga agent's instructions, then assign it a task.\"\n    documentation: str = \"https://docs.langflow.org/bundles-cuga\"\n    icon = \"bot\"\n    name = \"Cuga\"\n\n    memory_inputs = [set_advanced_true(component_input) for component_input in MemoryComponent().inputs]\n\n    inputs = [\n        DropdownInput(\n            name=\"agent_llm\",\n            display_name=\"Model Provider\",\n            info=\"The provider of the language model that the agent will use to generate responses.\",\n            options=[*MODEL_PROVIDERS_LIST, \"Custom\"],\n            value=\"OpenAI\",\n            real_time_refresh=True,\n            input_types=[],\n            options_metadata=[MODELS_METADATA[key] for key in MODEL_PROVIDERS_LIST] + [{\"icon\": \"brain\"}],\n        ),\n        *MODEL_PROVIDERS_DICT[\"OpenAI\"][\"inputs\"],\n        MultilineInput(\n            name=\"instructions\",\n            display_name=\"Instructions\",\n            info=(\n                \"Custom instructions for the agent to adhere to during its operation.\\n\"\n                \"Example:\\n\"\n                \"## Plan\\n\"\n                \"< planning instructions e.g. which tools and when to use>\\n\"\n                \"## Answer\\n\"\n                \"< final answer instructions how to answer>\"\n            ),\n            value=\"\",\n            advanced=False,\n        ),\n        IntInput(\n            name=\"n_messages\",\n            display_name=\"Number of Chat History Messages\",\n            value=100,\n            info=\"Number of chat history messages to retrieve.\",\n            advanced=True,\n            show=True,\n        ),\n        *LCToolsAgentComponent.get_base_inputs(),\n        BoolInput(\n            name=\"add_current_date_tool\",\n            display_name=\"Current Date\",\n            advanced=True,\n            info=\"If true, will add a tool to the agent that returns the current date.\",\n            value=True,\n        ),\n        BoolInput(\n            name=\"lite_mode\",\n            display_name=\"Enable CugaLite\",\n            info=\"Faster reasoning for simple tasks. Enable CugaLite for simple API tasks.\",\n            value=True,\n            advanced=True,\n        ),\n        IntInput(\n            name=\"lite_mode_tool_threshold\",\n            display_name=\"CugaLite Tool Threshold\",\n            info=\"Route to CugaLite if app has fewer than this many tools.\",\n            value=25,\n            advanced=True,\n        ),\n        DropdownInput(\n            name=\"decomposition_strategy\",\n            display_name=\"Decomposition Strategy\",\n            info=\"Strategy for task decomposition: 'flexible' allows multiple subtasks per app,\\n\"\n            \" 'exact' enforces one subtask per app.\",\n            options=[\"flexible\", \"exact\"],\n            value=\"flexible\",\n            advanced=True,\n        ),\n        BoolInput(\n            name=\"browser_enabled\",\n            display_name=\"Enable Browser\",\n            info=\"Toggle to enable a built-in browser tool for web scraping and searching.\",\n            value=False,\n            advanced=True,\n        ),\n        MultilineInput(\n            name=\"web_apps\",\n            display_name=\"Web applications\",\n            info=(\n                \"Cuga will automatically start this web application when Enable Browser is true. \"\n                \"Currently only supports one web application. Example: https://example.com\"\n            ),\n            value=\"\",\n            advanced=True,\n        ),\n    ]\n    outputs = [\n        Output(name=\"response\", display_name=\"Response\", method=\"message_response\"),\n    ]\n\n    async def call_agent(\n        self, current_input: str, tools: list[Tool], history_messages: list[Message], llm\n    ) -> AsyncIterator[dict[str, Any]]:\n        \"\"\"Execute the Cuga agent with the given input and tools.\n\n        This method initializes and runs the Cuga agent, processing the input through\n        the agent's workflow and yielding events for real-time monitoring.\n\n        Args:\n            current_input: The user input to process\n            tools: List of available tools for the agent\n            history_messages: Previous conversation history\n            llm: The language model instance to use\n\n        Yields:\n            dict: Agent events including tool usage, thinking, and final results\n\n        Raises:\n            ValueError: If there's an error in agent initialization\n            TypeError: If there's a type error in processing\n            RuntimeError: If there's a runtime error during execution\n            ConnectionError: If there's a connection issue\n        \"\"\"\n        yield {\n            \"event\": \"on_chain_start\",\n            \"run_id\": str(uuid.uuid4()),\n            \"name\": \"CUGA_initializing\",\n            \"data\": {\"input\": {\"input\": current_input, \"chat_history\": []}},\n        }\n        logger.debug(f\"[CUGA] LLM MODEL TYPE: {type(llm)}\")\n        if current_input:\n            # Import settings first\n            from cuga.config import settings\n\n            # Use Dynaconf's set() method to update settings dynamically\n            # This properly updates the settings object without corruption\n            logger.debug(\"[CUGA] Updating CUGA settings via Dynaconf set() method\")\n\n            settings.advanced_features.registry = False\n            settings.advanced_features.lite_mode = self.lite_mode\n            settings.advanced_features.lite_mode_tool_threshold = self.lite_mode_tool_threshold\n            settings.advanced_features.decomposition_strategy = self.decomposition_strategy\n\n            if self.browser_enabled:\n                logger.debug(\"[CUGA] browser_enabled is true, setting mode to hybrid\")\n                settings.advanced_features.mode = \"hybrid\"\n                settings.advanced_features.use_vision = False\n            else:\n                logger.debug(\"[CUGA] browser_enabled is false, setting mode to api\")\n                settings.advanced_features.mode = \"api\"\n\n            from cuga.backend.activity_tracker.tracker import ActivityTracker\n            from cuga.backend.cuga_graph.utils.agent_loop import StreamEvent\n            from cuga.backend.cuga_graph.utils.controller import (\n                AgentRunner as CugaAgent,\n            )\n            from cuga.backend.cuga_graph.utils.controller import (\n                ExperimentResult as AgentResult,\n            )\n            from cuga.backend.llm.models import LLMManager\n            from cuga.configurations.instructions_manager import InstructionsManager\n\n            # Reset var_manager if this is the first message in history\n            logger.debug(f\"[CUGA] Checking history_messages: count={len(history_messages) if history_messages else 0}\")\n            if not history_messages or len(history_messages) == 0:\n                logger.debug(\"[CUGA] First message in history detected, resetting var_manager\")\n            else:\n                logger.debug(f\"[CUGA] Continuing conversation with {len(history_messages)} previous messages\")\n\n            llm_manager = LLMManager()\n            llm_manager.set_llm(llm)\n            instructions_manager = InstructionsManager()\n\n            instructions_to_use = self.instructions or \"\"\n            logger.debug(f\"[CUGA] instructions are: {instructions_to_use}\")\n            instructions_manager.set_instructions_from_one_file(instructions_to_use)\n            tracker = ActivityTracker()\n            tracker.set_tools(tools)\n            thread_id = self.graph.session_id\n            logger.debug(f\"[CUGA] Using thread_id (session_id): {thread_id}\")\n            cuga_agent = CugaAgent(browser_enabled=self.browser_enabled, thread_id=thread_id)\n            if self.browser_enabled:\n                await cuga_agent.initialize_freemode_env(start_url=self.web_apps.strip(), interface_mode=\"browser_only\")\n            else:\n                await cuga_agent.initialize_appworld_env()\n\n            yield {\n                \"event\": \"on_chain_start\",\n                \"run_id\": str(uuid.uuid4()),\n                \"name\": \"CUGA_thinking...\",\n                \"data\": {\"input\": {\"input\": current_input, \"chat_history\": []}},\n            }\n            logger.debug(f\"[CUGA] current web apps are {self.web_apps}\")\n            logger.debug(f\"[CUGA] Processing input: {current_input}\")\n            try:\n                # Convert history to LangChain format for the event\n                logger.debug(f\"[CUGA] Converting {len(history_messages)} history messages to LangChain format\")\n                lc_messages = []\n                for i, msg in enumerate(history_messages):\n                    msg_text = getattr(msg, \"text\", \"N/A\")[:50] if hasattr(msg, \"text\") else \"N/A\"\n                    logger.debug(\n                        f\"[CUGA] Message {i}: type={type(msg)}, sender={getattr(msg, 'sender', 'N/A')}, \"\n                        f\"text={msg_text}...\"\n                    )\n                    if hasattr(msg, \"sender\") and msg.sender == \"Human\":\n                        lc_messages.append(HumanMessage(content=msg.text))\n                    else:\n                        lc_messages.append(AIMessage(content=msg.text))\n\n                logger.debug(f\"[CUGA] Converted to {len(lc_messages)} LangChain messages\")\n                await asyncio.sleep(0.5)\n\n                # 2. Build final response\n                response_parts = []\n\n                response_parts.append(f\"Processed input: '{current_input}'\")\n                response_parts.append(f\"Available tools: {len(tools)}\")\n                last_event: StreamEvent | None = None\n                tool_run_id: str | None = None\n                # 3. Chain end event with AgentFinish\n                async for event in cuga_agent.run_task_generic_yield(\n                    eval_mode=False, goal=current_input, chat_messages=lc_messages\n                ):\n                    logger.debug(f\"[CUGA] recieved event {event}\")\n                    if last_event is not None and tool_run_id is not None:\n                        logger.debug(f\"[CUGA] last event {last_event}\")\n                        try:\n                            # TODO: Extract data\n                            data_dict = json.loads(last_event.data)\n                        except json.JSONDecodeError:\n                            data_dict = last_event.data\n                        if last_event.name == \"CodeAgent\":\n                            data_dict = data_dict[\"code\"]\n                        yield {\n                            \"event\": \"on_tool_end\",\n                            \"run_id\": tool_run_id,\n                            \"name\": last_event.name,\n                            \"data\": {\"output\": data_dict},\n                        }\n                    if isinstance(event, StreamEvent):\n                        tool_run_id = str(uuid.uuid4())\n                        last_event = StreamEvent(name=event.name, data=event.data)\n                        tool_event = {\n                            \"event\": \"on_tool_start\",\n                            \"run_id\": tool_run_id,\n                            \"name\": event.name,\n                            \"data\": {\"input\": {}},\n                        }\n                        logger.debug(f\"[CUGA] Yielding tool_start event: {event.name}\")\n                        yield tool_event\n\n                    if isinstance(event, AgentResult):\n                        task_result = event\n                        end_event = {\n                            \"event\": \"on_chain_end\",\n                            \"run_id\": str(uuid.uuid4()),\n                            \"name\": \"CugaAgent\",\n                            \"data\": {\"output\": AgentFinish(return_values={\"output\": task_result.answer}, log=\"\")},\n                        }\n                        answer_preview = task_result.answer[:100] if task_result.answer else \"None\"\n                        logger.info(f\"[CUGA] Yielding chain_end event with answer: {answer_preview}...\")\n                        yield end_event\n\n            except (ValueError, TypeError, RuntimeError, ConnectionError) as e:\n                logger.error(f\"[CUGA] An error occurred: {e!s}\")\n                logger.error(f\"[CUGA] Traceback: {traceback.format_exc()}\")\n                error_msg = f\"CUGA Agent error: {e!s}\"\n                logger.error(f\"[CUGA] Error occurred: {error_msg}\")\n\n                # Emit error event\n                yield {\n                    \"event\": \"on_chain_error\",\n                    \"run_id\": str(uuid.uuid4()),\n                    \"name\": \"CugaAgent\",\n                    \"data\": {\"error\": error_msg},\n                }\n\n    async def message_response(self) -> Message:\n        \"\"\"Generate a message response using the Cuga agent.\n\n        This method processes the input through the Cuga agent and returns a structured\n        message response. It handles agent initialization, tool setup, and event processing.\n\n        Returns:\n            Message: The agent's response message\n\n        Raises:\n            Exception: If there's an error during agent execution\n        \"\"\"\n        logger.debug(\"[CUGA] Starting Cuga agent run for message_response.\")\n        logger.debug(f\"[CUGA] Agent input value: {self.input_value}\")\n\n        # Validate input is not empty\n        if not self.input_value or not str(self.input_value).strip():\n            msg = \"Message cannot be empty. Please provide a valid message.\"\n            raise ValueError(msg)\n\n        try:\n            from lfx.schema.content_block import ContentBlock\n            from lfx.schema.message import MESSAGE_SENDER_AI\n\n            llm_model, self.chat_history, self.tools = await self.get_agent_requirements()\n\n            # Create agent message for event processing\n            agent_message = Message(\n                sender=MESSAGE_SENDER_AI,\n                sender_name=\"Cuga\",\n                properties={\"icon\": \"Bot\", \"state\": \"partial\"},\n                content_blocks=[ContentBlock(title=\"Agent Steps\", contents=[])],\n                session_id=self.graph.session_id,\n            )\n\n            # Pre-assign an ID for event processing, following the base agent pattern\n            # This ensures streaming works even when not connected to ChatOutput\n            if not self.is_connected_to_chat_output():\n                # When not connected to ChatOutput, assign ID upfront for streaming support\n                agent_message.data[\"id\"] = uuid.uuid4()\n\n            # Get input text\n            input_text = self.input_value.text if hasattr(self.input_value, \"text\") else str(self.input_value)\n\n            # Create event iterator from call_agent\n            event_iterator = self.call_agent(\n                current_input=input_text, tools=self.tools or [], history_messages=self.chat_history, llm=llm_model\n            )\n\n            # Process events using the existing event processing system\n            from lfx.base.agents.events import process_agent_events\n\n            # Create a wrapper that forces DB updates for event handlers\n            # This ensures the UI can see loading steps in real-time via polling\n            async def force_db_update_send_message(message, id_=None, *, skip_db_update=False):  # noqa: ARG001\n                # Always persist to DB so polling-based UI shows loading steps in real-time\n                content_blocks_len = len(message.content_blocks[0].contents) if message.content_blocks else 0\n                logger.debug(\n                    f\"[CUGA] Sending message update - state: {message.properties.state}, \"\n                    f\"content_blocks: {content_blocks_len}\"\n                )\n\n                result = await self.send_message(message, id_=id_, skip_db_update=False)\n\n                logger.debug(f\"[CUGA] Message processed with ID: {result.id}\")\n                return result\n\n            result = await process_agent_events(\n                event_iterator, agent_message, cast(\"SendMessageFunctionType\", force_db_update_send_message)\n            )\n\n            logger.debug(\"[CUGA] Agent run finished successfully.\")\n            logger.debug(f\"[CUGA] Agent output: {result}\")\n\n        except Exception as e:\n            logger.error(f\"[CUGA] Error in message_response: {e}\")\n            logger.error(f\"[CUGA] An error occurred: {e!s}\")\n            logger.error(f\"[CUGA] Traceback: {traceback.format_exc()}\")\n\n            # Check if error is related to Playwright installation\n            error_str = str(e).lower()\n            if \"playwright install\" in error_str:\n                msg = (\n                    \"Playwright is not installed. Please install Playwright Chromium using: \"\n                    \"uv run -m playwright install chromium\"\n                )\n                raise ValueError(msg) from e\n\n            raise\n        else:\n            return result\n\n    async def get_agent_requirements(self):\n        \"\"\"Get the agent requirements for the Cuga agent.\n\n        This method retrieves and configures all necessary components for the agent\n        including the language model, chat history, and tools.\n\n        Returns:\n            tuple: A tuple containing (llm_model, chat_history, tools)\n\n        Raises:\n            ValueError: If no language model is selected or if there's an error\n                in model initialization\n        \"\"\"\n        llm_model, display_name = await self.get_llm()\n        if llm_model is None:\n            msg = \"No language model selected. Please choose a model to proceed.\"\n            raise ValueError(msg)\n        self.model_name = get_model_name(llm_model, display_name=display_name)\n\n        # Get memory data\n        self.chat_history = await self.get_memory_data()\n        if isinstance(self.chat_history, Message):\n            self.chat_history = [self.chat_history]\n\n        # Add current date tool if enabled\n        if self.add_current_date_tool:\n            if not isinstance(self.tools, list):\n                self.tools = []\n            current_date_tool = (await CurrentDateComponent(**self.get_base_args()).to_toolkit()).pop(0)\n            if not isinstance(current_date_tool, StructuredTool):\n                msg = \"CurrentDateComponent must be converted to a StructuredTool\"\n                raise TypeError(msg)\n            self.tools.append(current_date_tool)\n\n        # --- ADDED LOGGING START ---\n        logger.debug(\"[CUGA] Retrieved agent requirements: LLM, chat history, and tools.\")\n        logger.debug(f\"[CUGA] LLM model: {self.model_name}\")\n        logger.debug(f\"[CUGA] Number of chat history messages: {len(self.chat_history)}\")\n        logger.debug(f\"[CUGA] Tools available: {[tool.name for tool in self.tools]}\")\n        logger.debug(f\"[CUGA] metadata: {[tool.metadata for tool in self.tools]}\")\n        # --- ADDED LOGGING END ---\n\n        return llm_model, self.chat_history, self.tools\n\n    async def get_memory_data(self):\n        \"\"\"Retrieve chat history messages.\n\n        This method fetches the conversation history from memory, excluding the current\n        input message to avoid duplication.\n\n        Returns:\n            list: List of Message objects representing the chat history\n        \"\"\"\n        logger.debug(\"[CUGA] Retrieving chat history messages.\")\n        logger.debug(f\"[CUGA] Session ID: {self.graph.session_id}\")\n        logger.debug(f\"[CUGA] n_messages: {self.n_messages}\")\n        logger.debug(f\"[CUGA] input_value: {self.input_value}\")\n        logger.debug(f\"[CUGA] input_value type: {type(self.input_value)}\")\n        logger.debug(f\"[CUGA] input_value id: {getattr(self.input_value, 'id', None)}\")\n\n        messages = (\n            await MemoryComponent(**self.get_base_args())\n            .set(session_id=str(self.graph.session_id), order=\"Ascending\", n_messages=self.n_messages)\n            .retrieve_messages()\n        )\n        logger.debug(f\"[CUGA] Retrieved {len(messages)} messages from memory\")\n        return [\n            message for message in messages if getattr(message, \"id\", None) != getattr(self.input_value, \"id\", None)\n        ]\n\n    async def get_llm(self):\n        \"\"\"Get language model for the Cuga agent.\n\n        This method initializes and configures the language model based on the\n        selected provider and parameters.\n\n        Returns:\n            tuple: A tuple containing (llm_model, display_name)\n\n        Raises:\n            ValueError: If the model provider is invalid or model initialization fails\n        \"\"\"\n        logger.debug(\"[CUGA] Getting language model for the agent.\")\n        logger.debug(f\"[CUGA] Requested LLM provider: {self.agent_llm}\")\n\n        if not isinstance(self.agent_llm, str):\n            logger.debug(\"[CUGA] Agent LLM is already a model instance.\")\n            return self.agent_llm, None\n\n        try:\n            provider_info = MODEL_PROVIDERS_DICT.get(self.agent_llm)\n            if not provider_info:\n                msg = f\"Invalid model provider: {self.agent_llm}\"\n                raise ValueError(msg)\n\n            component_class = provider_info.get(\"component_class\")\n            display_name = component_class.display_name\n            inputs = provider_info.get(\"inputs\")\n            prefix = provider_info.get(\"prefix\", \"\")\n            logger.debug(f\"[CUGA] Successfully built LLM model from provider: {self.agent_llm}\")\n            return self._build_llm_model(component_class, inputs, prefix), display_name\n\n        except (AttributeError, ValueError, TypeError, RuntimeError) as e:\n            await logger.aerror(f\"[CUGA] Error building {self.agent_llm} language model: {e!s}\")\n            msg = f\"Failed to initialize language model: {e!s}\"\n            raise ValueError(msg) from e\n\n    def _build_llm_model(self, component, inputs, prefix=\"\"):\n        \"\"\"Build LLM model with parameters.\n\n        This method constructs a language model instance using the provided component\n        class and input parameters.\n\n        Args:\n            component: The LLM component class to instantiate\n            inputs: List of input field definitions\n            prefix: Optional prefix for parameter names\n\n        Returns:\n            The configured LLM model instance\n        \"\"\"\n        model_kwargs = {}\n        for input_ in inputs:\n            if hasattr(self, f\"{prefix}{input_.name}\"):\n                model_kwargs[input_.name] = getattr(self, f\"{prefix}{input_.name}\")\n        return component.set(**model_kwargs).build_model()\n\n    def set_component_params(self, component):\n        \"\"\"Set component parameters based on provider.\n\n        This method configures component parameters according to the selected\n        model provider's requirements.\n\n        Args:\n            component: The component to configure\n\n        Returns:\n            The configured component\n        \"\"\"\n        provider_info = MODEL_PROVIDERS_DICT.get(self.agent_llm)\n        if provider_info:\n            inputs = provider_info.get(\"inputs\")\n            prefix = provider_info.get(\"prefix\")\n            model_kwargs = {}\n            for input_ in inputs:\n                if hasattr(self, f\"{prefix}{input_.name}\"):\n                    model_kwargs[input_.name] = getattr(self, f\"{prefix}{input_.name}\")\n            return component.set(**model_kwargs)\n        return component\n\n    def delete_fields(self, build_config: dotdict, fields: dict | list[str]) -> None:\n        \"\"\"Delete specified fields from build_config.\n\n        This method removes unwanted fields from the build configuration.\n\n        Args:\n            build_config: The build configuration dictionary\n            fields: Fields to remove (can be dict or list of strings)\n        \"\"\"\n        for field in fields:\n            build_config.pop(field, None)\n\n    def update_input_types(self, build_config: dotdict) -> dotdict:\n        \"\"\"Update input types for all fields in build_config.\n\n        This method ensures all fields in the build configuration have proper\n        input types defined.\n\n        Args:\n            build_config: The build configuration to update\n\n        Returns:\n            dotdict: Updated build configuration with input types\n        \"\"\"\n        for key, value in build_config.items():\n            if isinstance(value, dict):\n                if value.get(\"input_types\") is None:\n                    build_config[key][\"input_types\"] = []\n            elif hasattr(value, \"input_types\") and value.input_types is None:\n                value.input_types = []\n        return build_config\n\n    async def update_build_config(\n        self, build_config: dotdict, field_value: str, field_name: str | None = None\n    ) -> dotdict:\n        \"\"\"Update build configuration based on field changes.\n\n        This method dynamically updates the component's build configuration when\n        certain fields change, particularly the model provider selection.\n\n        Args:\n            build_config: The current build configuration\n            field_value: The new value for the field\n            field_name: The name of the field being changed\n\n        Returns:\n            dotdict: Updated build configuration\n\n        Raises:\n            ValueError: If required keys are missing from the configuration\n        \"\"\"\n        if field_name in (\"agent_llm\",):\n            build_config[\"agent_llm\"][\"value\"] = field_value\n            provider_info = MODEL_PROVIDERS_DICT.get(field_value)\n            if provider_info:\n                component_class = provider_info.get(\"component_class\")\n                if component_class and hasattr(component_class, \"update_build_config\"):\n                    build_config = await update_component_build_config(\n                        component_class, build_config, field_value, \"model_name\"\n                    )\n\n            provider_configs: dict[str, tuple[dict, list[dict]]] = {\n                provider: (\n                    MODEL_PROVIDERS_DICT[provider][\"fields\"],\n                    [\n                        MODEL_PROVIDERS_DICT[other_provider][\"fields\"]\n                        for other_provider in MODEL_PROVIDERS_DICT\n                        if other_provider != provider\n                    ],\n                )\n                for provider in MODEL_PROVIDERS_DICT\n            }\n            if field_value in provider_configs:\n                fields_to_add, fields_to_delete = provider_configs[field_value]\n\n                # Delete fields from other providers\n                for fields in fields_to_delete:\n                    self.delete_fields(build_config, fields)\n\n                # Add provider-specific fields\n                if field_value == \"OpenAI\" and not any(field in build_config for field in fields_to_add):\n                    build_config.update(fields_to_add)\n                else:\n                    build_config.update(fields_to_add)\n                build_config[\"agent_llm\"][\"input_types\"] = []\n            elif field_value == \"Custom\":\n                # Delete all provider fields\n                self.delete_fields(build_config, ALL_PROVIDER_FIELDS)\n                # Update with custom component\n                custom_component = DropdownInput(\n                    name=\"agent_llm\",\n                    display_name=\"Language Model\",\n                    options=[*sorted(MODEL_PROVIDERS), \"Custom\"],\n                    value=\"Custom\",\n                    real_time_refresh=True,\n                    input_types=[\"LanguageModel\"],\n                    options_metadata=[MODELS_METADATA[key] for key in sorted(MODELS_METADATA.keys())]\n                    + [{\"icon\": \"brain\"}],\n                )\n                build_config.update({\"agent_llm\": custom_component.to_dict()})\n\n            # Update input types for all fields\n            build_config = self.update_input_types(build_config)\n\n            # Validate required keys\n            default_keys = [\n                \"code\",\n                \"_type\",\n                \"agent_llm\",\n                \"tools\",\n                \"input_value\",\n                \"add_current_date_tool\",\n                \"instructions\",\n                \"agent_description\",\n                \"max_iterations\",\n                \"handle_parsing_errors\",\n                \"verbose\",\n            ]\n            missing_keys = [key for key in default_keys if key not in build_config]\n            if missing_keys:\n                msg = f\"Missing required keys in build_config: {missing_keys}\"\n                raise ValueError(msg)\n\n        if (\n            isinstance(self.agent_llm, str)\n            and self.agent_llm in MODEL_PROVIDERS_DICT\n            and field_name in MODEL_DYNAMIC_UPDATE_FIELDS\n        ):\n            provider_info = MODEL_PROVIDERS_DICT.get(self.agent_llm)\n            if provider_info:\n                component_class = provider_info.get(\"component_class\")\n                component_class = self.set_component_params(component_class)\n                prefix = provider_info.get(\"prefix\")\n                if component_class and hasattr(component_class, \"update_build_config\"):\n                    if isinstance(field_name, str) and isinstance(prefix, str):\n                        field_name = field_name.replace(prefix, \"\")\n                    build_config = await update_component_build_config(\n                        component_class, build_config, field_value, \"model_name\"\n                    )\n        return dotdict({k: v.to_dict() if hasattr(v, \"to_dict\") else v for k, v in build_config.items()})\n\n    async def _get_tools(self) -> list[Tool]:\n        \"\"\"Build agent tools.\n\n        This method constructs the list of tools available to the Cuga agent,\n        including component tools and any additional configured tools.\n\n        Returns:\n            list[Tool]: List of available tools for the agent\n        \"\"\"\n        logger.debug(\"[CUGA] Building agent tools.\")\n        component_toolkit = _get_component_toolkit()\n        tools_names = self._build_tools_names()\n        agent_description = self.get_tool_description()\n        description = f\"{agent_description}{tools_names}\"\n        tools = component_toolkit(component=self).get_tools(\n            tool_name=\"Call_CugaAgent\", tool_description=description, callbacks=self.get_langchain_callbacks()\n        )\n        if hasattr(self, \"tools_metadata\"):\n            tools = component_toolkit(component=self, metadata=self.tools_metadata).update_tools_metadata(tools=tools)\n        logger.debug(f\"[CUGA] Tools built: {[tool.name for tool in tools]}\")\n        return tools\n"
              },
              "decomposition_strategy": {
                "_input_type": "DropdownInput",
                "advanced": true,
                "combobox": false,
                "dialog_inputs": {},
                "display_name": "Decomposition Strategy",
                "dynamic": false,
                "external_options": {},
                "info": "Strategy for task decomposition: 'flexible' allows multiple subtasks per app,\n 'exact' enforces one subtask per app.",
                "input_types": [],
                "name": "decomposition_strategy",
                "options": [
                  "flexible",
                  "exact"
                ],
                "options_metadata": [],
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": "flexible"
              },
              "frequency_penalty": {
                "_input_type": "SliderInput",
                "advanced": true,
                "display_name": "Frequency Penalty",
                "dynamic": false,
                "info": "Penalty for frequency of token usage.",
                "input_types": [],
                "max_label": "",
                "max_label_icon": "",
                "min_label": "",
                "min_label_icon": "",
                "name": "frequency_penalty",
                "override_skip": false,
                "placeholder": "",
                "range_spec": {
                  "max": 2,
                  "min": -2,
                  "step": 0.01,
                  "step_type": "float"
                },
                "required": false,
                "show": true,
                "slider_buttons": false,
                "slider_buttons_options": [],
                "slider_input": false,
                "title_case": false,
                "tool_mode": false,
                "track_in_telemetry": false,
                "type": "slider",
                "value": 0.5
              },
              "handle_parsing_errors": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Handle Parse Errors",
                "dynamic": false,
                "info": "Should the Agent fix errors when reading user input for better processing?",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "handle_parsing_errors",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              },
              "input_value": {
                "_input_type": "MessageInput",
                "advanced": false,
                "display_name": "Input",
                "dynamic": false,
                "info": "The input provided by the user for the agent to process.",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "input_value",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": true,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "instructions": {
                "_input_type": "MultilineInput",
                "advanced": false,
                "ai_enabled": false,
                "copy_field": false,
                "display_name": "Instructions",
                "dynamic": false,
                "info": "Custom instructions for the agent to adhere to during its operation.\nExample:\n## Plan\n< planning instructions e.g. which tools and when to use>\n## Answer\n< final answer instructions how to answer>",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "multiline": true,
                "name": "instructions",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": "## Plan\nFor the filesystem application: write or read files only from `/Users/aviyaeli/Documents/temp/cuga-demo/cuga-demo/cuga_workspace/cuga_workspace`\n\nMy assistant is Jane and her email is cuga.demo@gmail.com"
              },
              "is_refresh": false,
              "lite_mode": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Enable CugaLite",
                "dynamic": false,
                "info": "Faster reasoning for simple tasks. Enable CugaLite for simple API tasks.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "lite_mode",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              },
              "lite_mode_tool_threshold": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "CugaLite Tool Threshold",
                "dynamic": false,
                "info": "Route to CugaLite if app has fewer than this many tools.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "lite_mode_tool_threshold",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "int",
                "value": 25
              },
              "logit_bias": {
                "_input_type": "StrInput",
                "advanced": true,
                "display_name": "Logit Bias",
                "dynamic": false,
                "info": "JSON string of token IDs to bias or suppress (e.g., {\"1003\": -100, \"1004\": 100}).",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "logit_bias",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "logprobs": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Log Probabilities",
                "dynamic": false,
                "info": "Whether to return log probabilities of the output tokens.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "logprobs",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              },
              "max_iterations": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "Max Iterations",
                "dynamic": false,
                "info": "The maximum number of attempts the agent can make to complete its task before it stops.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "max_iterations",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "int",
                "value": 15
              },
              "max_tokens": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "Max Tokens",
                "dynamic": false,
                "info": "The maximum number of tokens to generate.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "max_tokens",
                "override_skip": false,
                "placeholder": "",
                "range_spec": {
                  "max": 4096,
                  "min": 1,
                  "step": 0.1,
                  "step_type": "float"
                },
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "int",
                "value": 1000
              },
              "model_name": {
                "_input_type": "DropdownInput",
                "advanced": false,
                "combobox": true,
                "dialog_inputs": {},
                "display_name": "Model Name",
                "dynamic": false,
                "external_options": {},
                "info": "To see the model names, first choose a provider. Then, enter your API key and click the refresh button next to the model name.",
                "input_types": [],
                "name": "model_name",
                "options": [
                  "ibm/granite-3-2-8b-instruct",
                  "ibm/granite-3-3-8b-instruct",
                  "ibm/granite-3-8b-instruct",
                  "ibm/granite-4-h-small",
                  "ibm/granite-guardian-3-8b",
                  "meta-llama/llama-3-2-11b-vision-instruct",
                  "meta-llama/llama-3-2-90b-vision-instruct",
                  "meta-llama/llama-3-3-70b-instruct",
                  "meta-llama/llama-3-405b-instruct",
                  "meta-llama/llama-4-maverick-17b-128e-instruct-fp8",
                  "meta-llama/llama-guard-3-11b-vision",
                  "mistral-large-2512",
                  "mistralai/mistral-medium-2505",
                  "mistralai/mistral-small-3-1-24b-instruct-2503",
                  "openai/gpt-oss-120b"
                ],
                "options_metadata": [],
                "override_skip": false,
                "placeholder": "",
                "real_time_refresh": true,
                "refresh_button": true,
                "required": true,
                "show": true,
                "title_case": false,
                "toggle": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "str",
                "value": "openai/gpt-oss-120b"
              },
              "n_messages": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "Number of Chat History Messages",
                "dynamic": false,
                "info": "Number of chat history messages to retrieve.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "n_messages",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "int",
                "value": 100
              },
              "presence_penalty": {
                "_input_type": "SliderInput",
                "advanced": true,
                "display_name": "Presence Penalty",
                "dynamic": false,
                "info": "Penalty for token presence in prior text.",
                "input_types": [],
                "max_label": "",
                "max_label_icon": "",
                "min_label": "",
                "min_label_icon": "",
                "name": "presence_penalty",
                "override_skip": false,
                "placeholder": "",
                "range_spec": {
                  "max": 2,
                  "min": -2,
                  "step": 0.01,
                  "step_type": "float"
                },
                "required": false,
                "show": true,
                "slider_buttons": false,
                "slider_buttons_options": [],
                "slider_input": false,
                "title_case": false,
                "tool_mode": false,
                "track_in_telemetry": false,
                "type": "slider",
                "value": 0.3
              },
              "project_id": {
                "_input_type": "StrInput",
                "advanced": false,
                "display_name": "watsonx Project ID",
                "dynamic": false,
                "info": "The project ID or deployment space ID that is associated with the foundation model.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "project_id",
                "override_skip": false,
                "placeholder": "",
                "required": true,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": "7b749282-560a-4c66-b194-b9a866a30342"
              },
              "seed": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "Random Seed",
                "dynamic": false,
                "info": "The random seed for the model.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "seed",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "int",
                "value": 8
              },
              "stop_sequence": {
                "_input_type": "StrInput",
                "advanced": true,
                "display_name": "Stop Sequence",
                "dynamic": false,
                "info": "Sequence where generation should stop.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "name": "stop_sequence",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              },
              "temperature": {
                "_input_type": "SliderInput",
                "advanced": true,
                "display_name": "Temperature",
                "dynamic": false,
                "info": "Controls randomness, higher values increase diversity.",
                "input_types": [],
                "max_label": "",
                "max_label_icon": "",
                "min_label": "",
                "min_label_icon": "",
                "name": "temperature",
                "override_skip": false,
                "placeholder": "",
                "range_spec": {
                  "max": 2,
                  "min": 0,
                  "step": 0.01,
                  "step_type": "float"
                },
                "required": false,
                "show": true,
                "slider_buttons": false,
                "slider_buttons_options": [],
                "slider_input": false,
                "title_case": false,
                "tool_mode": false,
                "track_in_telemetry": false,
                "type": "slider",
                "value": 0.1
              },
              "tools": {
                "_input_type": "HandleInput",
                "advanced": false,
                "display_name": "Tools",
                "dynamic": false,
                "info": "These are the tools that the agent can use to help with tasks.",
                "input_types": [
                  "Tool"
                ],
                "list": true,
                "list_add_label": "Add More",
                "name": "tools",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "other",
                "value": ""
              },
              "top_logprobs": {
                "_input_type": "IntInput",
                "advanced": true,
                "display_name": "Top Log Probabilities",
                "dynamic": false,
                "info": "Number of most likely tokens to return at each position.",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "top_logprobs",
                "override_skip": false,
                "placeholder": "",
                "range_spec": {
                  "max": 20,
                  "min": 1,
                  "step": 0.1,
                  "step_type": "float"
                },
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "int",
                "value": 3
              },
              "top_p": {
                "_input_type": "SliderInput",
                "advanced": true,
                "display_name": "Top P",
                "dynamic": false,
                "info": "The cumulative probability cutoff for token selection. Lower values mean sampling from a smaller, more top-weighted nucleus.",
                "input_types": [],
                "max_label": "",
                "max_label_icon": "",
                "min_label": "",
                "min_label_icon": "",
                "name": "top_p",
                "override_skip": false,
                "placeholder": "",
                "range_spec": {
                  "max": 1,
                  "min": 0,
                  "step": 0.01,
                  "step_type": "float"
                },
                "required": false,
                "show": true,
                "slider_buttons": false,
                "slider_buttons_options": [],
                "slider_input": false,
                "title_case": false,
                "tool_mode": false,
                "track_in_telemetry": false,
                "type": "slider",
                "value": 0.9
              },
              "verbose": {
                "_input_type": "BoolInput",
                "advanced": true,
                "display_name": "Verbose",
                "dynamic": false,
                "info": "",
                "input_types": [],
                "list": false,
                "list_add_label": "Add More",
                "name": "verbose",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_metadata": true,
                "track_in_telemetry": true,
                "type": "bool",
                "value": true
              },
              "web_apps": {
                "_input_type": "MultilineInput",
                "advanced": true,
                "ai_enabled": false,
                "copy_field": false,
                "display_name": "Web applications",
                "dynamic": false,
                "info": "Cuga will automatically start this web application when Enable Browser is true. Currently only supports one web application. Example: https://example.com",
                "input_types": [
                  "Message"
                ],
                "list": false,
                "list_add_label": "Add More",
                "load_from_db": false,
                "multiline": true,
                "name": "web_apps",
                "override_skip": false,
                "placeholder": "",
                "required": false,
                "show": true,
                "title_case": false,
                "tool_mode": false,
                "trace_as_input": true,
                "trace_as_metadata": true,
                "track_in_telemetry": false,
                "type": "str",
                "value": ""
              }
            },
            "tool_mode": false
          },
          "showNode": true,
          "type": "Cuga"
        },
        "dragging": false,
        "id": "Cuga-h25LW",
        "measured": {
          "height": 755,
          "width": 320
        },
        "position": {
          "x": 1759.5390234287574,
          "y": 74.42642947803681
        },
        "selected": true,
        "type": "genericNode"
      }
    ],
    "viewport": {
      "x": -623.8434773314191,
      "y": 80.04713214898203,
      "zoom": 1.0012983774476478
    }
  },
  "description": "Example of CUGA working with workspace files, CRM application and Email to prepare for a conference",
  "endpoint_name": null,
  "id": "af63ae2e-2804-4ab5-9259-4e337a09a401",
  "is_component": false,
  "last_tested_version": "1.7.0",
  "name": "CUGA Langflow Demo - Conference Preparation",
  "tags": []
}